group_by(anon_baby_id) %>%
mutate(visit = row_number()) %>%
ungroup()
View(first_visit_only)
first_visit_only <- final_data_strat%>%
arrange(anon_baby_id, age) %>%
group_by(anon_baby_id) %>%
mutate(visit = row_number()) %>%
ungroup() %>%
filter(visit==1)
prop_strategy<- first_visit_only %>%
group_by(strategy) %>%
tally() %>%
mutate(prop = n/sum(n))
prop_strategy<- prop_strategy %>%
mutate(strategy = fct_reorder(prop_strategy$strategy, prop_strategy$prop, .desc=F))
ggplot(prop_strategy, aes(fill=strategy, values= n, na.rm=T)) +
geom_waffle (n_rows=23, color="white")+
scale_fill_manual (name = "Family Strategy", values =c("#7570b3","#33a02c","#b2df8a", "#d95f02", "#FFC107", "#1f78b4")) +
labs(x="", title = "Proportion of Use of Family Strategies")+
theme(axis.text.x= element_blank(), axis.ticks = element_blank())+
coord_equal()+
theme_void()
439-11
ggplot(prop_strategy, aes(fill=strategy, values= n, na.rm=T)) +
geom_waffle (n_rows=22, color="white")+
scale_fill_manual (name = "Family Strategy", values =c("#7570b3","#33a02c","#b2df8a", "#d95f02", "#FFC107", "#1f78b4")) +
labs(x="", title = "Proportion of Use of Family Strategies")+
theme(axis.text.x= element_blank(), axis.ticks = element_blank())+
coord_equal()+
theme_void()
knitr::opts_chunk$set(echo = TRUE)
#Family language strategy visualization
first_visit_only <- final_data_strat%>%
arrange(anon_baby_id, age) %>%
group_by(anon_baby_id) %>%
mutate(visit = row_number()) %>%
ungroup() %>%
filter(visit==1) #439 data from first visit only
prop_strategy<- first_visit_only %>%
group_by(strategy) %>%
tally() %>%
mutate(prop = n/sum(n))
prop_strategy<- prop_strategy %>%
mutate(strategy = fct_reorder(prop_strategy$strategy, prop_strategy$prop, .desc=F))
#Waffle plot
figure_1<- ggplot(prop_strategy, aes(fill=strategy, values= n, na.rm=T)) +
geom_waffle (n_rows=22, color="white")+
scale_fill_manual (name = "Family Strategy", values =c("#7570b3","#33a02c","#b2df8a", "#d95f02", "#FFC107", "#1f78b4")) +
labs(x="", title = "Proportion of Use of Family Strategies")+
theme(axis.text.x= element_blank(), axis.ticks = element_blank())+
coord_equal()+
theme_void()
View(prop_strategy)
library(here)
library(tidyverse)
library(dplyr)
library(lme4)
library(lmerTest)
library(rstatix)
library(papeR)
library(knitr)
load(here("anonymized_data/final_merged_data.Rda"))
load(here("anonymized_data/final_data_no_exc.Rda"))
load(here("anonymized_data/final_data_strat.Rda"))
#subseting to get data only from each child's first visit to the lab
first_visit_only <- final_data_strat%>%
arrange(anon_baby_id, age) %>%
group_by(anon_baby_id) %>%
mutate(visit = row_number()) %>%
ungroup() %>%
filter(visit==1) #439 data from first visit only
#n when only taking first visit
n_keep_first_visit<-first_visit_only %>%
distinct(unique_id)%>%
tally()
#Calculating how many families use each strategy and its corresponding %
prop_strategy<- first_visit_only %>%
group_by(strategy) %>%
tally() %>%
mutate(prop = n/sum(n)) %>%
mutate(perc= prop*100)
perc_both_parents_biling<- prop_strategy %>%
filter(strategy=="both_parents-bilingual") %>%
print(perc)
perc_both_parents_biling<- prop_strategy %>%
filter(strategy=="both_parents-bilingual")
perc_both_parents_biling<- prop_strategy %>%
filter(strategy=="both-parents-bilingual")
perc_both_parents_biling<- prop_strategy %>%
filter(strategy=="both-parents-bilingual") %>%
print(perc)
View(perc_both_parents_biling)
perc_both_parents_biling<- prop_strategy %>%
filter(strategy=="both-parents-bilingual") %>%
select(perc)
knitr::opts_chunk$set(echo = TRUE)
library(ggsankey)
load(here("anonymized_data/longitudinal_data.Rda"))
library(here)
library(tidyverse)
library(dplyr)
library(lme4)
library(lmerTest)
library(rstatix)
library(papeR)
library(knitr)
library(waffle)
library(ggsankey)
load(here("anonymized_data/final_merged_data.Rda"))
load(here("anonymized_data/final_data_no_exc.Rda"))
load(here("anonymized_data/final_data_strat.Rda"))
load(here("anonymized_data/longitudinal_data.Rda"))
View(final_data_strat)
fre_by_strategy <- final_data_strat  %>%
select(c(strategy, fre_exp)) %>%
group_by(strategy) %>%
summarise(mean(fre_exp))
library(here)
library(tidyverse)
library(dplyr)
library(lme4)
library(lmerTest)
library(rstatix)
library(papeR)
library(knitr)
library(waffle)
library(ggsankey)
load(here("anonymized_data/final_merged_data.Rda"))
load(here("anonymized_data/final_data_no_exc.Rda"))
load(here("anonymized_data/final_data_strat.Rda"))
load(here("anonymized_data/longitudinal_data.Rda"))
#Family language strategy visualization
#subseting to get data only from each child's first visit to the lab
first_visit_only <- final_data_strat%>%
arrange(anon_baby_id, age) %>%
group_by(anon_baby_id) %>%
mutate(visit = row_number()) %>%
ungroup() %>%
filter(visit==1) #439 data from first visit only
#n when only taking first visit
n_keep_first_visit<-first_visit_only %>%
distinct(unique_id)%>%
tally()
#Calculating how many families use each strategy and its corresponding %
prop_strategy<- first_visit_only %>%
group_by(strategy) %>%
tally() %>%
mutate(prop = n/sum(n)) %>%
mutate(perc= prop*100)
perc_both_parents_biling<- prop_strategy %>%
filter(strategy=="both-parents-bilingual") %>%
select(perc)
prop_strategy<- prop_strategy %>%
mutate(strategy = fct_reorder(prop_strategy$strategy, prop_strategy$prop, .desc=F))
#Waffle plot
figure_1<- ggplot(prop_strategy, aes(fill=strategy, values= n, na.rm=T)) +
geom_waffle (n_rows=22, color="white")+
scale_fill_manual (name = "Family Strategy", values =c("#7570b3","#33a02c","#b2df8a", "#d95f02", "#FFC107", "#1f78b4")) +
labs(x="", title = "Proportion of Use of Family Strategies")+
theme(axis.text.x= element_blank(), axis.ticks = element_blank())+
coord_equal()+
theme_void()
fre_by_strategy <- first_visit_only  %>%
select(c(strategy, fre_exp)) %>%
group_by(strategy) %>%
summarise(mean(fre_exp))
fre_by_strategy <- first_visit_only  %>%
select(c(strategy, fre_exp)) #%>%
View(fre_by_strategy)
fre_by_strategy <- first_visit_only  %>%
select(c(strategy, fre_exp)) %>%
group_by(strategy) #%>%
View(fre_by_strategy)
fre_by_strategy <- first_visit_only  %>%
select(c(strategy, fre_exp)) %>%
group_by(strategy) %>%
summarise(mean(fre_exp))
View(fre_by_strategy)
fre_by_strategy <- first_visit_only  %>%
select(c(strategy, fre_exp)) %>%
group_by(strategy, fre_exp) %>%
summarise(mean(fre_exp))
fre_by_strategy <- first_visit_only  %>%
select(c(strategy, fre_exp)) %>%
group_by(strategy) %>%
summarise(mean(fre_exp))
View(first_visit_only)
eng_by_strategy <- first_visit_only  %>%
select(c(strategy, eng_exp)) %>%
group_by(strategy) %>%
summarise(mean(eng_exp))
eng_by_strategy <- first_visit_only  %>%
select(c(strategy, eng_exp)) %>%
ungroup()%>%
group_by(strategy) %>%
summarise(mean(eng_exp))
eng_by_strategy <- first_visit_only  %>%
select(c(strategy, eng_exp))
View(eng_by_strategy)
eng_by_strategy <- first_visit_only  %>%
select(c(strategy, eng_exp)) %>%
group_by(strategy) #%>%
str(eng_by_strategy)
eng_by_strategy <- first_visit_only  %>%
select(c(strategy, eng_exp)) %>%
group_by(strategy) %>%
summarise(mean(eng_by_strategy$eng_exp))
eng_by_strategy<- eng_by_strategy %>%
summarise(mean(eng_exp))
ggplot(fre_by_strategy, aes( x=strategy , y=`mean(fre_exp)`, fill = strategy )) +
geom_col() +
scale_fill_manual (name = "Family Strategy", values =c("#4d4d4d","#57bc53","#008c77", "#4169e1", "#f6cb7f", "#f94f80")) +
theme_bw() +
labs(title= "Mean french exposure by strategy")
ggplot(fre_by_strategy, aes( x=strategy , y=mean(fre_exp), fill = strategy )) +
geom_col() +
scale_fill_manual (name = "Family Strategy", values =c("#4d4d4d","#57bc53","#008c77", "#4169e1", "#f6cb7f", "#f94f80")) +
theme_bw() +
labs(title= "Mean french exposure by strategy")
View(fre_by_strategy)
summarise(mean(fre_by_strategy$fre_exp))
mean(fre_by_strategy$fre_exp)
fre_by_strategy <- first_visit_only  %>%
select(c(strategy, fre_exp)) %>%
group_by(strategy)%>%
summarise(mean(fre_exp))
library(here)
library(tidyverse)
library(dplyr)
library(lme4)
library(lmerTest)
library(rstatix)
library(papeR)
library(knitr)
library(waffle)
library(ggsankey)
load(here("anonymized_data/final_merged_data.Rda"))
load(here("anonymized_data/final_data_no_exc.Rda"))
load(here("anonymized_data/final_data_strat.Rda"))
load(here("anonymized_data/longitudinal_data.Rda"))
#subseting to get data only from each child's first visit to the lab
first_visit_only <- final_data_strat%>%
arrange(anon_baby_id, age) %>%
group_by(anon_baby_id) %>%
mutate(visit = row_number()) %>%
ungroup() %>%
filter(visit==1) #439 data from first visit only
fre_by_strategy <- first_visit_only  %>%
select(c(strategy, fre_exp)) %>%
group_by(strategy)%>%
summarise(mean(fre_exp))
fre_by_strategy <- first_visit_only  %>%
select(c(strategy, fre_exp)) %>%
group_by(c(strategy, fre_exp))%>%
summarise(mean(fre_exp))
#select only relevant variables
longitudinal_data <- longitudinal_data %>%
select(age, strategy, unique_id, anon_baby_id)
longitudinal_data<- longitudinal_data %>%
arrange(anon_baby_id, age) %>%
group_by(anon_baby_id) %>%
mutate(visit = row_number()) %>%
ungroup()
wider_longitudinal <- longitudinal_data %>%
select(anon_baby_id, visit, strategy) %>%
filter(str_detect(strategy, "single-parent", negate=T))
wider_longitudinal <- pivot_wider(wider_longitudinal,
names_from = visit, values_from = strategy ) %>%
rename(visit_1 = "1", visit_2 = "2", visit_3 ="3", visit_4 ="4" )
for_sankey <- wider_longitudinal %>%
make_long(visit_1, visit_2)
for_sankey <- for_sankey %>%
mutate(node= fct_relevel (node, "both-parents-bilingual", "one-parent-bilingual", "one-language-at-home", "one-parent-one-lang-flex", "one-parent-one-lang-strict"))
p1<- ggplot(for_sankey, aes(x = x,
next_x = next_x,
node = node,
next_node = next_node,
fill = factor(node), label=node)) +
geom_sankey()
p2<- p1+
scale_fill_manual(name= "x", values = c("#f94f80", "#f6cb7f", "#4169e1", "#008c77", "#57bc53"))
figure_3<- p2 +
geom_sankey_label(size=3, color="black", fill="white")+
theme_bw()+
theme(legend.position = "none", axis.ticks = element_blank(), axis.text.y = element_blank()) +
labs(title="Stability of Family Strategies Across Visit", x="")
print(figure_3)
View(wider_longitudinal)
View(for_sankey)
p2<- p2 +
geom_sankey_label(size=3, color="black", fill="white")+
theme_bw()+
theme(legend.position = "none", axis.ticks = element_blank(), axis.text.y = element_blank()) +
labs(title="Stability of Family Strategies Across Visit", x="")
print(p2)
knitr::opts_chunk$set(echo = TRUE)
library(here)
library(tidyverse)
library(ggplot2)
library(ggsankey)
library(waffle)
load(here("anonymized_data/longitudinal_data.Rda"))
load(here("anonymized_data/final_data_strat.Rda"))
#select only relevant variables
longitudinal_data <- longitudinal_data %>%
select(age, strategy, unique_id, anon_baby_id)
longitudinal_data<- longitudinal_data %>%
arrange(anon_baby_id, age) %>%
group_by(anon_baby_id) %>%
mutate(visit = row_number()) %>%
ungroup()
wider_longitudinal <- longitudinal_data %>%
select(anon_baby_id, visit, strategy) %>%
filter(str_detect(strategy, "single-parent", negate=T))
wider_longitudinal <- pivot_wider(wider_longitudinal,
names_from = visit, values_from = strategy ) %>%
rename(visit_1 = "1", visit_2 = "2", visit_3 ="3", visit_4 ="4" )
for_sankey <- wider_longitudinal %>%
make_long(visit_1, visit_2)
for_sankey <- for_sankey %>%
mutate(node= fct_relevel (node, "both-parents-bilingual", "one-parent-bilingual", "one-language-at-home", "one-parent-one-lang-flex", "one-parent-one-lang-strict"))
p1<- ggplot(for_sankey, aes(x = x,
next_x = next_x,
node = node,
next_node = next_node,
fill = factor(node), label=node)) +
geom_sankey()
p2<- p1+
scale_fill_manual(name= "x", values = c("#f94f80", "#f6cb7f", "#4169e1", "#008c77", "#57bc53"))
p2<- p2 +
geom_sankey_label(size=3, color="black", fill="white")+
theme_bw()+
theme(legend.position = "none", axis.ticks = element_blank(), axis.text.y = element_blank()) +
labs(title="Stability of Family Strategies Across Visit", x="")
print(p2)
knitr::opts_chunk$set(echo = TRUE)
#select only relevant variables
longitudinal_data <- longitudinal_data %>%
select(age, strategy, unique_id, anon_baby_id)
longitudinal_data<- longitudinal_data %>%
arrange(anon_baby_id, age) %>%
group_by(anon_baby_id) %>%
mutate(visit = row_number()) %>%
ungroup()
wider_longitudinal <- longitudinal_data %>%
select(anon_baby_id, visit, strategy) %>%
filter(str_detect(strategy, "single-parent", negate=T))
wider_longitudinal <- pivot_wider(wider_longitudinal,
names_from = visit, values_from = strategy ) %>%
rename(visit_1 = "1", visit_2 = "2", visit_3 ="3", visit_4 ="4" )
for_sankey <- wider_longitudinal %>%
make_long(visit_1, visit_2)
for_sankey <- for_sankey %>%
mutate(node= fct_relevel (node, "both-parents-bilingual", "one-parent-bilingual", "one-language-at-home", "one-parent-one-lang-flex", "one-parent-one-lang-strict"))
p1<- ggplot(for_sankey, aes(x = x,
next_x = next_x,
node = node,
next_node = next_node,
fill = factor(node), label=node)) +
geom_sankey()
p2<- p1+
scale_fill_manual(name= "x", values = c("#f94f80", "#f6cb7f", "#4169e1", "#008c77", "#57bc53"))
p2<- p2 +
geom_sankey_label(size=3, color="black", fill="white")+
theme_bw()+
theme(legend.position = "none", axis.ticks = element_blank(), axis.text.y = element_blank()) +
labs(title="Stability of Family Strategies Across Visit", x="")
print(p2)
library(here)
library(tidyverse)
library(dplyr)
library(lme4)
library(lmerTest)
library(rstatix)
library(papeR)
library(knitr)
library(waffle)
library(ggsankey)
load(here("anonymized_data/final_merged_data.Rda"))
load(here("anonymized_data/final_data_no_exc.Rda"))
load(here("anonymized_data/final_data_strat.Rda"))
load(here("anonymized_data/longitudinal_data.Rda"))
#Family language strategy visualization
#subseting to get data only from each child's first visit to the lab
first_visit_only <- final_data_strat%>%
arrange(anon_baby_id, age) %>%
group_by(anon_baby_id) %>%
mutate(visit = row_number()) %>%
ungroup() %>%
filter(visit==1) #439 data from first visit only
#n when only taking first visit
n_keep_first_visit<-first_visit_only %>%
distinct(unique_id)%>%
tally()
#Calculating how many families use each strategy and its corresponding %
prop_strategy<- first_visit_only %>%
group_by(strategy) %>%
tally() %>%
mutate(prop = n/sum(n)) %>%
mutate(perc= prop*100)
perc_both_parents_biling<- prop_strategy %>%
filter(strategy=="both-parents-bilingual") %>%
select(perc)
prop_strategy<- prop_strategy %>%
mutate(strategy = fct_reorder(prop_strategy$strategy, prop_strategy$prop, .desc=F))
#Waffle plot
figure_1<- ggplot(prop_strategy, aes(fill=strategy, values= n, na.rm=T)) +
geom_waffle (n_rows=22, color="white")+
scale_fill_manual (name = "Family Strategy", values =c("#7570b3","#33a02c","#b2df8a", "#d95f02", "#FFC107", "#1f78b4")) +
labs(x="", title = "Proportion of Use of Family Strategies")+
theme(axis.text.x= element_blank(), axis.ticks = element_blank())+
coord_equal()+
theme_void()
print(figure_1)
#select only relevant variables
longitudinal_data <- longitudinal_data %>%
select(age, strategy, unique_id, anon_baby_id)
longitudinal_data<- longitudinal_data %>%
arrange(anon_baby_id, age) %>%
group_by(anon_baby_id) %>%
mutate(visit = row_number()) %>%
ungroup()
wider_longitudinal <- longitudinal_data %>%
select(anon_baby_id, visit, strategy) %>%
filter(str_detect(strategy, "single-parent", negate=T))
wider_longitudinal <- pivot_wider(wider_longitudinal,
names_from = visit, values_from = strategy ) %>%
rename(visit_1 = "1", visit_2 = "2", visit_3 ="3", visit_4 ="4" )
for_sankey <- wider_longitudinal %>%
make_long(visit_1, visit_2)
for_sankey <- for_sankey %>%
mutate(node= fct_relevel (node, "both-parents-bilingual", "one-parent-bilingual", "one-language-at-home", "one-parent-one-lang-flex", "one-parent-one-lang-strict"))
p1<- ggplot(for_sankey, aes(x = x,
next_x = next_x,
node = node,
next_node = next_node,
fill = factor(node), label=node)) +
geom_sankey()
p2<- p1+
scale_fill_manual(name= "x", values = c("#f94f80", "#f6cb7f", "#4169e1", "#008c77", "#57bc53"))
p2<- p2 +
geom_sankey_label(size=3, color="black", fill="white")+
theme_bw()+
theme(legend.position = "none", axis.ticks = element_blank(), axis.text.y = element_blank()) +
labs(title="Stability of Family Strategies Across Visit", x="")
print(p2)
knitr::opts_chunk$set(echo = TRUE)
library(here)
library(tidyverse)
library(dplyr)
library(lme4)
library(lmerTest)
library(rstatix)
library(papeR)
library(knitr)
library(waffle)
library(ggsankey)
load(here("anonymized_data/final_merged_data.Rda"))
load(here("anonymized_data/final_data_no_exc.Rda"))
load(here("anonymized_data/final_data_strat.Rda"))
load(here("anonymized_data/longitudinal_data.Rda"))
#subseting to get data only from each child's first visit to the lab
first_visit_only <- final_data_strat%>%
arrange(anon_baby_id, age) %>%
group_by(anon_baby_id) %>%
mutate(visit = row_number()) %>%
ungroup() %>%
filter(visit==1) #439 data from first visit only
fre_by_strategy <- final_data_fre  %>%
select(c(strategy, fre_exp)) %>%
group_by(strategy) %>%
summarise(mean= mean(fre_exp))
fre_by_strategy <- first_visit_only  %>%
select(c(strategy, fre_exp)) %>%
group_by(strategy) %>%
summarise(mean= mean(fre_exp))
unique(first_visit_only$fre_exp)
library(here)
library(tidyverse)
library(dplyr)
library(lme4)
library(lmerTest)
library(rstatix)
library(papeR)
library(knitr)
library(waffle)
library(ggsankey)
load(here("anonymized_data/final_merged_data.Rda"))
load(here("anonymized_data/final_data_no_exc.Rda"))
load(here("anonymized_data/final_data_strat.Rda"))
load(here("anonymized_data/longitudinal_data.Rda"))
View(final_data_strat)
fre_by_strategy <- final_data_strat  %>%
select(c(strategy, fre_exp)) %>%
group_by(strategy) %>%
summarise(mean= mean(fre_exp))
fre_by_strategy <- final_data_strat  %>%
select(c(strategy, fre_exp)) #%>%
View(fre_by_strategy)
fre_by_strategy <- final_data_strat  %>%
select(c(strategy, fre_exp)) %>%
group_by(strategy) #%>%
View(fre_by_strategy)
fre_by_strategy <- final_data_strat  %>%
select(c(strategy, fre_exp)) %>%
group_by(strategy) %>%
summarize(mean= mean(fre_exp))
fre_by_strategy <- final_data_strat  %>%
select(c(strategy, fre_exp)) %>%
group_by(strategy) %>%
dplyr::summarize(mean= mean(fre_exp))
