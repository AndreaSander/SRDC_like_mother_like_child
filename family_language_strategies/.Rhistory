select(visit, strategy, length_between_visits, anon_baby_id) %>%
filter(visit == c(1,2)) %>%
filter(!strategy == "single-parent") %>%
pivot_wider(names_from = visit, values_from = strategy) %>%
rename(visit_1 = "1") %>%
rename(visit_2 = "2") %>%
mutate(change_strat = case_when(visit_1 == visit_2 ~"no_change",
TRUE~ "change"))
FE_for_long_glmer<- FE_for_long_glmer %>%
drop_na("visit_1") #One NA because family used french and Heritage in the first visit and french and english in the second.
FE_count_change <- FE_for_long_glmer %>%
group_by(change_strat) %>%
tally() %>%
mutate(perc = (n/sum(n)*100))
FE_strategy_change <- FE_for_long_glmer %>%
filter(change_strat=="change") %>%
group_by(visit_2) %>%
tally() %>%
mutate(perc = (n/sum(n)*100))
long_model<- glmer(as.factor(change_strat) ~ scale(length_between_visits) +(1|anon_baby_id), data = FE_for_long_glmer, family="binomial")
summary(long_model)
############ make sankey graph ########
FE_for_sankey <- FE_for_long_glmer %>%
select(-change_strat) %>%
make_long("visit_1", "visit_2")
FE_for_sankey <- FE_for_sankey %>%
mutate(node= fct_relevel (node, "both-parents-bilingual", "one-parent-bilingual", "one-language-at-home", "one-parent-one-language"))
FE_p1<- ggplot(FE_for_sankey, aes(x = x,
next_x = next_x,
node = node,
next_node = next_node,
fill = factor(node), label=node )) +
geom_sankey()
FE_p2<- FE_p1+
scale_fill_manual(name= "x", values = c(my_orange, my_yellow, my_green, my_blue))
FE_p2<- FE_p2 +
geom_sankey_label(size=5, color="black", fill="white")+
theme_bw()+
theme(axis.text.x = element_text(size=20),axis.title = element_text(size=20), plot.title = element_text(size=20), legend.position = "none", axis.ticks = element_blank(), axis.text.y = element_blank())+
labs(title="Stability of Family Strategies Across Visits", x="")
## AGE BY STRATEGY GRAPHS
figure_3_a <-ggplot(FE_for_anova_graphs, aes( x=age , y=fre_exp, color=strategy)) +
geom_smooth(alpha=0.2)+
scale_color_manual (name = "Family Strategy", values =c(my_orange, my_yellow, my_blue)) +
theme_bw() +
ylim(0, 100)+
theme(axis.text.x = element_text(size=20), axis.text.y = element_text(size=20),axis.title = element_text(size=20), plot.title = element_text(size=20), legend.position = "none")+
labs(title= "A. French exposure changes by age/strategy")
figure_3_b <-ggplot(FE_for_anova_graphs, aes( x=age , y=eng_exp, color=strategy)) +
geom_smooth(alpha=0.2)+
scale_color_manual (name = "Family Strategy", values =c(my_orange, my_yellow, my_blue)) +
theme_bw() +
ylim(0, 100)+
theme(axis.text.x = element_text(size=20), axis.text.y = element_text(size=20),axis.title = element_text(size=20), plot.title = element_text(size=20), legend.text= element_text(size=12),legend.title= element_text(size=12))+
labs(title= "B. English exposure changes by age/strategy")
figure_3<- figure_3_a + figure_3_b
#ggsave(file="Figure_3.png", width=25, height=7, dpi=300)
mom_long<- FE_long_analyses %>%
filter(!strategy=="single-parent") %>%
select(anon_baby_id, unique_id, l1, l2, care1_l1, care1_l2, visit, strategy, length_between_visits) %>%
mutate(caregiver_1_french_use = case_when(l1=="French"~care1_l1,
l2=="French"~care1_l2)) %>%
mutate(caregiver_1_english_use = case_when(l1=="English"~care1_l1,
l2=="English"~care1_l2)) %>%
filter(visit == c(1,2)) %>%
mutate(visit = as.character(as.numeric(visit))) %>%
mutate(visit_a = visit) %>%#need two visit columns to give the df the appropriate shape for the sankey graph
pivot_wider(names_from = visit, values_from = caregiver_1_french_use) %>%
rename("Visit_1_Fre" = "1") %>%
rename("Visit_2_Fre" = "2") %>%
pivot_wider(names_from = visit_a, values_from = caregiver_1_english_use) %>%
rename("Visit_1_Eng" = "1") %>%
rename("Visit_2_Eng" = "2") %>%
group_by(anon_baby_id)%>%
summarise_all(na.omit) %>%#Collapsing IDs so that there is one row per baby cause otherwise the sankey wont work
ungroup()
mom_long_french<- mom_long %>%
select(anon_baby_id, length_between_visits, Visit_1_Fre, Visit_2_Fre)
mom_long_english<- mom_long %>%
select(anon_baby_id, length_between_visits, Visit_1_Eng, Visit_2_Eng)
mom_long_fre_s <- mom_long_french %>%
make_long("Visit_1_Fre","Visit_2_Fre")
mom_long_eng_s <- mom_long_english %>%
make_long("Visit_1_Eng", "Visit_2_Eng")
figure_m_a <- ggplot(mom_long_fre_s , aes(x = x,
next_x = next_x,
node = node,
next_node = next_node,
fill = factor(node), label=node)) +
geom_sankey_label(size=5, color="black", fill="white")+
theme_bw()+
scale_fill_manual(values = c("#dac291", "#41ae76", "#75638b"))+
theme(legend.position = "none")
print(figure_m_a)
figure_m_a <- ggplot(mom_long_fre_s , aes(x = x,
next_x = next_x,
node = node,
next_node = next_node,
fill = factor(node), label=node)) +
geom_sankey_label(size=5, color="black", fill="white")+
theme_bw()+
theme(legend.position = "none")
print(figure_m_a)
figure_m_a <- ggplot(mom_long_fre_s , aes(x = x,
next_x = next_x,
node = node,
next_node = next_node,
fill = factor(node), label=node)) +
geom_sankey(flow.color = "black") +
geom_sankey_label(size=5, color="black", fill="white")+
scale_fill_manual(values = c("#dac291", "#41ae76", "#75638b"))+
theme_bw()+
theme(legend.position = "none")
print(figure_m_a)
figure_m_b <- ggplot(mom_long_eng_s , aes(x = x,
next_x = next_x,
node = node,
next_node = next_node,
fill = factor(node), label=node)) +
geom_sankey(flow.color = "black") +
scale_fill_manual(values = c("#dac291", "#41ae76", "#75638b"))+
geom_sankey_label(size=5, color="black", fill="white")+
theme_bw()+
theme(legend.position = "none")
figure_m<- figure_m_a + figure_m_b
print(figure_m)
figure_m_a <- ggplot(mom_long_fre_s , aes(x = x,
next_x = next_x,
node = node,
next_node = next_node,
fill = factor(node), label=node)) +
geom_sankey(flow.color = "black") +
geom_sankey_label(size=5, color="black", fill="white")+
scale_fill_manual(values = c("#dac291", "#41ae76", "#75638b"))+
theme_bw()+
theme(legend.position = "none") +
labs(title= "A. Mothers' change of language use French")
figure_m_b <- ggplot(mom_long_eng_s , aes(x = x,
next_x = next_x,
node = node,
next_node = next_node,
fill = factor(node), label=node)) +
geom_sankey(flow.color = "black") +
scale_fill_manual(values = c("#dac291", "#41ae76", "#75638b"))+
geom_sankey_label(size=5, color="black", fill="white")+
theme_bw()+
theme(legend.position = "none")+
labs(title= "A. Mothers' change of language use English")
figure_m<- figure_m_a + figure_m_b
print(figure_m)
figure_m_b <- ggplot(mom_long_eng_s , aes(x = x,
next_x = next_x,
node = node,
next_node = next_node,
fill = factor(node), label=node)) +
geom_sankey(flow.color = "black") +
scale_fill_manual(values = c("#dac291", "#41ae76", "#75638b"))+
geom_sankey_label(size=5, color="black", fill="white")+
theme_bw()+
theme(legend.position = "none")+
labs(title= "B. Mothers' change of language use English")
figure_m<- figure_m_a + figure_m_b
print(figure_m)
figure_d_a <- ggplot(dad_long_fre_s , aes(x = x,
next_x = next_x,
node = node,
next_node = next_node,
fill = factor(node), label=node)) +
geom_sankey(flow.color = "black") +
scale_fill_manual(values = c("#dac291", "#41ae76", "#75638b"))+
geom_sankey_label(size=5, color="black", fill="white")+
theme_bw()+
theme(legend.position = "none")+
labs(title= "A. Fathers' change of language use French")
dad_long<- FE_long_analyses %>%
filter(!strategy=="single-parent") %>%
select(anon_baby_id, unique_id, l1, l2, care2_l1, care2_l2, visit, strategy, length_between_visits) %>%
mutate(caregiver_2_french_use = case_when(l1=="French"~care2_l1,
l2=="French"~care2_l2)) %>%
mutate(caregiver_2_english_use = case_when(l1=="English"~care2_l1,
l2=="English"~care2_l2)) %>%
filter(visit == c(1,2)) %>%
mutate(visit = as.character(as.numeric(visit))) %>%
mutate(visit_a = visit) %>%#need two visit columns to give the df the appropriate shape for the sankey graph
pivot_wider(names_from = visit, values_from = caregiver_2_french_use) %>%
rename("Visit_1_Fre" = "1") %>%
rename("Visit_2_Fre" = "2") %>%
pivot_wider(names_from = visit_a, values_from = caregiver_2_english_use) %>%
rename("Visit_1_Eng" = "1") %>%
rename("Visit_2_Eng" = "2") %>%
group_by(anon_baby_id)%>%
summarise_all(na.omit) %>%#Collapsing IDs so that there is one row per baby cause otherwise the sankey wont work
ungroup() %>%
drop_na(Visit_1_Fre)
dad_long_french<- dad_long %>%
select(anon_baby_id, length_between_visits, Visit_1_Fre, Visit_2_Fre)
dad_long_english<- dad_long %>%
select(anon_baby_id, length_between_visits, Visit_1_Eng, Visit_2_Eng)
dad_long_fre_s <- dad_long_french %>%
make_long("Visit_1_Fre","Visit_2_Fre")
dad_long_eng_s <- dad_long_english %>%
make_long("Visit_1_Eng", "Visit_2_Eng")
figure_d_a <- ggplot(dad_long_fre_s , aes(x = x,
next_x = next_x,
node = node,
next_node = next_node,
fill = factor(node), label=node)) +
geom_sankey(flow.color = "black") +
scale_fill_manual(values = c("#dac291", "#41ae76", "#75638b"))+
geom_sankey_label(size=5, color="black", fill="white")+
theme_bw()+
theme(legend.position = "none")+
labs(title= "A. Fathers' change of language use French")
figure_d_b <- ggplot(dad_long_eng_s , aes(x = x,
next_x = next_x,
node = node,
next_node = next_node,
fill = factor(node), label=node)) +
geom_sankey(flow.color = "black") +
scale_fill_manual(values = c("#dac291", "#41ae76", "#75638b"))+
geom_sankey_label(size=5, color="black", fill="white")+
theme_bw()+
theme(legend.position = "none")+
labs(title= "B. Fathers' change of language use English")
figure_d<- figure_d_a + figure_d_b
print(figure_d)
dad_long<- FE_long_analyses %>%
filter(!strategy=="single-parent") %>%
select(anon_baby_id, unique_id, l1, l2, care2_l1, care2_l2, visit, strategy, length_between_visits) %>%
mutate(caregiver_2_french_use = case_when(l1=="French"~care2_l1,
l2=="French"~care2_l2)) %>%
mutate(caregiver_2_english_use = case_when(l1=="English"~care2_l1,
l2=="English"~care2_l2)) %>%
filter(visit == c(1,2)) %>%
mutate(visit = as.character(as.numeric(visit))) %>%
mutate(visit_a = visit) %>%#need two visit columns to give the df the appropriate shape for the sankey graph
pivot_wider(names_from = visit, values_from = caregiver_2_french_use) %>%
rename("Visit_1_Fre" = "1") %>%
rename("Visit_2_Fre" = "2") %>%
pivot_wider(names_from = visit_a, values_from = caregiver_2_english_use) %>%
rename("Visit_1_Eng" = "1") %>%
rename("Visit_2_Eng" = "2") %>%
group_by(anon_baby_id)%>%
summarise_all(na.omit) %>%#Collapsing IDs so that there is one row per baby cause otherwise the sankey wont work
ungroup() %>%
drop_na(c(Visit_1_Fre, Visit_1_Eng, Visit_2_Fre, Visit_2_Eng))
dad_long_french<- dad_long %>%
select(anon_baby_id, length_between_visits, Visit_1_Fre, Visit_2_Fre)
dad_long_english<- dad_long %>%
select(anon_baby_id, length_between_visits, Visit_1_Eng, Visit_2_Eng)
dad_long_fre_s <- dad_long_french %>%
make_long("Visit_1_Fre","Visit_2_Fre")
dad_long_eng_s <- dad_long_english %>%
make_long("Visit_1_Eng", "Visit_2_Eng")
figure_d_a <- ggplot(dad_long_fre_s , aes(x = x,
next_x = next_x,
node = node,
next_node = next_node,
fill = factor(node), label=node)) +
geom_sankey(flow.color = "black") +
scale_fill_manual(values = c("#dac291", "#41ae76", "#75638b"))+
geom_sankey_label(size=5, color="black", fill="white")+
theme_bw()+
theme(legend.position = "none")+
labs(title= "A. Fathers' change of language use French")
figure_d_b <- ggplot(dad_long_eng_s , aes(x = x,
next_x = next_x,
node = node,
next_node = next_node,
fill = factor(node), label=node)) +
geom_sankey(flow.color = "black") +
scale_fill_manual(values = c("#dac291", "#41ae76", "#75638b"))+
geom_sankey_label(size=5, color="black", fill="white")+
theme_bw()+
theme(legend.position = "none")+
labs(title= "B. Fathers' change of language use English")
figure_d<- figure_d_a + figure_d_b
print(figure_d)
View(dad_long_french)
dad_long_french<- dad_long %>%
select(anon_baby_id, length_between_visits, Visit_1_Fre, Visit_2_Fre) %>%
drop_na(c(Visit_1_Fre, Visit_2_Fre))
dad_long_french<- dad_long %>%
select(anon_baby_id, length_between_visits, Visit_1_Fre, Visit_2_Fre) %>%
mutate(Visit_1_Fre = case_when(Visit_1_Fre == "NA"~"never",
TRUE~ Visit_1_Fre))
dad_long_fre_s <- dad_long_french %>%
make_long("Visit_1_Fre","Visit_2_Fre")
figure_d_a <- ggplot(dad_long_fre_s , aes(x = x,
next_x = next_x,
node = node,
next_node = next_node,
fill = factor(node), label=node)) +
geom_sankey(flow.color = "black") +
scale_fill_manual(values = c("#dac291", "#41ae76", "#75638b"))+
geom_sankey_label(size=5, color="black", fill="white")+
theme_bw()+
theme(legend.position = "none")+
labs(title= "A. Fathers' change of language use French")
Print(figure_d_a)
print(figure_d_a)
print(figure_d_b)
figure_d<- figure_d_a + figure_d_b
print(figure_d)
figure_y_a <-ggplot(data= lm_fre, aes( x=age , y=fre_exp, color=caregiver_1_french_use)) +
geom_smooth(alpha=0.2)+
theme_bw() +
ylim(0, 1)+
scale_color_manual(values = c("#dac291", "#41ae76", "#75638b"))+
theme(axis.text.x = element_text(size=20), axis.text.y = element_text(size=20),axis.title = element_text(size=20), plot.title = element_text(size=20), legend.position = "none")+
labs(title= "A. French exposure changes by age/mother French use")
print(figure_y_a)
figure_y_a <-ggplot(data= lm_fre, aes( x=age , y=fre_exp, color=caregiver_1_french_use)) +
geom_smooth(alpha=0.2)+
theme_bw() +
ylim(0, 1)+
scale_color_manual(values = c("#dac291", "#41ae76", "#75638b"))+
scale_fill_manual(values = c("#dac291", "#41ae76", "#75638b"))+
theme(axis.text.x = element_text(size=20), axis.text.y = element_text(size=20),axis.title = element_text(size=20), plot.title = element_text(size=20), legend.position = "none")+
labs(title= "A. French exposure changes by age/mother French use")
print(figure_y_a)
figure_y_a <-ggplot(data= lm_fre, aes( x=age , y=fre_exp, color=caregiver_1_french_use)) +
geom_line(size=2)+
geom_smooth(alpha=0.2)+
theme_bw() +
ylim(0, 1)+
scale_color_manual(values = c("#dac291", "#41ae76", "#75638b"))+
theme(axis.text.x = element_text(size=20), axis.text.y = element_text(size=20),axis.title = element_text(size=20), plot.title = element_text(size=20), legend.position = "none")+
labs(title= "A. French exposure changes by age/mother French use")
print(figure_y_a)
figure_y_a <-ggplot(data= lm_fre, aes( x=age , y=fre_exp, color=caregiver_1_french_use)) +
geom_smooth(alpha=0.2)+
theme_bw() +
ylim(0, 1)+
scale_color_manual(values = c("#dac291", "#41ae76", "#75638b"))+
theme(axis.text.x = element_text(size=20), axis.text.y = element_text(size=20),axis.title = element_text(size=20), plot.title = element_text(size=20), legend.position = "none")+
labs(title= "A. French exposure changes by age/mother French use")
print(figure_y_a)
figure_y_a <-ggplot(data= lm_fre, aes( x=age , y=fre_exp, color=caregiver_1_french_use)) +
geom_smooth(alpha=0.2, size=2)+
theme_bw() +
ylim(0, 1)+
scale_color_manual(values = c("#dac291", "#41ae76", "#75638b"))+
theme(axis.text.x = element_text(size=20), axis.text.y = element_text(size=20),axis.title = element_text(size=20), plot.title = element_text(size=20), legend.position = "none")+
labs(title= "A. French exposure changes by age/mother French use")
print(figure_y_a)
print(figure_y_a)
figure_y_a <-ggplot(data= lm_fre, aes( x=age , y=fre_exp, color=caregiver_1_french_use)) +
geom_smooth(alpha=0.2, size=2)+
theme_bw() +
ylim(0, 1)+
scale_color_manual(values = c("#41ae76", "#dac291", "#75638b"))+
theme(axis.text.x = element_text(size=20), axis.text.y = element_text(size=20),axis.title = element_text(size=20), plot.title = element_text(size=20), legend.position = "none")+
labs(title= "A. French exposure changes by age/mother French use")
figure_y_b <-ggplot(data= lm_fre, aes( x=age , y=fre_exp, color=caregiver_2_french_use)) +
geom_smooth(alpha=0.2, size=2)+
theme_bw() +
ylim(0, 1)+
scale_color_manual(values = c("#41ae76", "#dac291", "#75638b"))+
theme(axis.text.x = element_text(size=20), axis.text.y = element_text(size=20),axis.title = element_text(size=20), plot.title = element_text(size=20))+
labs(title= "B. French exposure changes by age/father French use")
figure_y_c <-ggplot(data= lm_eng, aes( x=age , y=eng_exp, color=caregiver_1_english_use)) +
geom_smooth(alpha=0.2, size=2)+
theme_bw() +
ylim(0, 1)+
scale_color_manual(values = c("#41ae76", "#dac291", "#75638b"))+
theme(axis.text.x = element_text(size=20), axis.text.y = element_text(size=20),axis.title = element_text(size=20), plot.title = element_text(size=20), legend.position = "none")+
labs(title= "C. English exposure changes by age/mother English use")
figure_y_d <-ggplot(data= lm_eng, aes( x=age , y=eng_exp, color=caregiver_2_english_use)) +
geom_smooth(alpha=0.2, size=2)+
theme_bw() +
ylim(0, 1)+
scale_color_manual(values = c("#41ae76", "#dac291", "#75638b"))+
theme(axis.text.x = element_text(size=20), axis.text.y = element_text(size=20),axis.title = element_text(size=20), plot.title = element_text(size=20), legend.position = "none")+
labs(title= "D. English exposure changes by age/father English use")
figure_y<- figure_y_a + figure_y_b + figure_y_c + figure_y_d
print(figure_y)
print(figure_d)
figure_3_a <-ggplot(FE_for_anova_graphs, aes( x=age , y=fre_exp, color=strategy)) +
geom_smooth(alpha=0.2, size=2)+
scale_color_manual (name = "Family Strategy", values =c(my_orange, my_yellow, my_blue)) +
theme_bw() +
ylim(0, 100)+
theme(axis.text.x = element_text(size=20), axis.text.y = element_text(size=20),axis.title = element_text(size=20), plot.title = element_text(size=20), legend.position = "none")+
labs(title= "A. French exposure changes by age/strategy")
figure_3_b <-ggplot(FE_for_anova_graphs, aes( x=age , y=eng_exp, color=strategy)) +
geom_smooth(alpha=0.2, size= 2)+
scale_color_manual (name = "Family Strategy", values =c(my_orange, my_yellow, my_blue)) +
theme_bw() +
ylim(0, 100)+
theme(axis.text.x = element_text(size=20), axis.text.y = element_text(size=20),axis.title = element_text(size=20), plot.title = element_text(size=20), legend.text= element_text(size=12),legend.title= element_text(size=12))+
labs(title= "B. English exposure changes by age/strategy")
figure_3<- figure_3_a + figure_3_b
print(figure_3)
library(lubridate)
library(sparkline)
library(webshot)
library(htmlwidgets)
library(formattable)
library(here)
library(lme4)
library(lmerTest)
library(rstatix)
library(papeR)
library(knitr)
library(waffle)
library(ggsankey)
library(dplyr)
library(tidyverse)
library(patchwork)
library(ggpubr)
library(broom)
library(janitor)
library(glmmTMB)
library(DHARMa)
library(betareg)
library(emmeans)
library(ggiraphExtra)
library(ggeffects)
library(mvtnorm)
library(boot)
library(bbmle)
library(performance)
library(see)
load(here("anonymized_data/final_merged_data.Rda"))
load(here("anonymized_data/final_data_no_exc.Rda"))
load(here("anonymized_data/final_data_strat.Rda"))
load(here("anonymized_data/longitudinal_data.Rda"))
#Saving my palette to use in visualizations
my_yellow<-"#FFC107"
my_orange<- "#D95F02"
my_blue<- "#1F78B4"
my_green<- "#33a02c"
my_purple<- "#683f6d"
knitr::opts_chunk$set(echo = TRUE)
library(here)
library(tidyverse)
library(lubridate)
load(here("anonymized_data/LEQ_data.Rda"))
load(here("anonymized_data/demographic_data.Rda"))
#rename
LEQ_data <- final_fam_str
demographic_data <- demog_anonym
#gets gender under a unified scale, as it had different scales for different studies
demographic_data <- demographic_data %>%
mutate(gender=case_when(
gender %in% c("male", "M") ~ "male",
gender %in% c("female", "F") ~ "female",
gender == 1 ~ "male",
gender == 0 ~ "female"))
#renames studies to make paralell to the way they are named in the LEQ data.
demographic_data <- demographic_data %>%
mutate(study = tolower(study)) %>%
mutate(study = case_when(study =="cogmisp" ~ "cogmisp24",
study=="faceprince-12"~"faceprince12",
study=="faceprince-18"~"faceprince18",
study=="littlemix-8"~"littlemix8",
study=="many_babies_12"~"manybabies12",
study=="many_babies_6"~"manybabies6",
study=="segment_8"~"segment8",
TRUE ~ study)) %>%
mutate(unique_id = paste(anon_baby_id, study, sep="_")) #creates a unique identifier per each baby per each study
#gets rid of duplicated demographic data
demographic_data <- demographic_data %>%
add_count(unique_id) %>%
filter(n==1)
#adding unique identifier to LEQ data
LEQ_data <-
LEQ_data %>%
mutate(study = tolower(study)) %>%
mutate(unique_id = paste(anon_baby_id, study, sep="_"))
final_data <-
right_join(demographic_data, LEQ_data ,  by= c("unique_id", "study", "anon_baby_id"))
#clean date of birth error in one participant
final_data <- final_data %>%
mutate(leq_date = as.character(leq_date))
final_data$leq_date[final_data$leq_date== "2016-08-07"] <- "2017-03-28"
final_data$do_birth<-as.Date(as.character(final_data$do_birth))
final_data$leq_date<-as.Date(as.character(final_data$leq_date))
final_data <- final_data %>%
mutate(age= interval(start= do_birth, end=leq_date)/
duration(n=1, unit="months"))
#save data before exclusions
final_data_no_exc<- final_data
save(final_data_no_exc, file=here("anonymized_data/final_data_no_exc.Rda"))
View(final_data)
load("Z:/Lab Studies/2020_FamilyLanguageStrategy/05_Data/Data entry/2020_data_entry_comparison/baby_trace.Rda")
View(baby_trace)
final_data <- final_data %>%
mutate (type_of_family= case_when(anon_baby_id == 5815080 ~ "same_sex_parents",
anon_baby_id == 5373360 ~ "same_sex_parents",
care1_l1 %in% c("never", "NA") & care1_l2 %in% c("never", "NA") & care1_l3 %in% c("never", "NA") & care1_l4 %in% c("never", "NA") ~ "single-parent",
care2_l1 %in% c("never", "NA") & care2_l2 %in% c("never", "NA") & care2_l3 %in% c("never", "NA") & care2_l4 %in% c("never", "NA") ~ "single-parent",
TRUE ~ "mother-father family"))
View(final_data)
final_data_no_exc<- final_data
save(final_data_no_exc, file=here("anonymized_data/final_data_no_exc.Rda"))
final_data <- final_data %>%
group_by(unique_id, exp_l1, exp_l2)%>%
mutate(total_l1_l2_exp=(sum(exp_l1,exp_l2,na.rm = T))) %>%
ungroup() %>%
filter(total_l1_l2_exp>=90) #59 exclusions for more than 10% exposure to a third language
save(final_data, file=here("anonymized_data/final_merged_data.Rda"))
unique(final_data$type_of_family)
View(final_data)
View(demog_anonym)
library(here)
library(tidyverse)
library(lubridate)
load(here("anonymized_data/LEQ_data.Rda"))
load(here("anonymized_data/demographic_data.Rda"))
View(demog_anonym)
