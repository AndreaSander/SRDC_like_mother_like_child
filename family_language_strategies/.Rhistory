FE_anova_model_french <- aov(fre_exp ~ strategy, data= FE_for_anovas)
FE_aov_fre<- tidy(FE_anova_model_french)
FE_tukey_fre_s<- TukeyHSD(FE_anova_model_french)
FE_fre_F <- FE_aov_fre$statistic
FE_fre_p <- FE_aov_fre$p.value
##English ANOVA objects
FE_anova_model_english <- aov(eng_exp ~ strategy, data= FE_for_anovas)
FE_aov_eng<- tidy(FE_anova_model_english)
FE_tukey_eng_s<- TukeyHSD(FE_anova_model_english)
FE_eng_F <- FE_aov_eng$statistic
FE_eng_p <- FE_aov_eng$p.value
her_for_anova_graphs<-FEH %>%
filter(!bilingual_type == "fre-eng")
her_for_anova_graphs$strategy<- factor(her_for_anova_graphs$strategy, levels= c("both-parents-bilingual", "one-parent-bilingual", "one-parent-one-lang", "one-language-at-home", "single-parent"))
her_for_anova_graphs <- her_for_anova_graphs %>%
filter(!strategy %in% c("single-parent", "one-language-at-home"))
figure_10_a <-ggplot(her_for_anova_graphs, aes( x=strategy , y=fre_exp, fill = strategy )) +
stat_summary(geom="bar")+
stat_summary() +
ylim(0,100) +
scale_fill_manual (name = "Family Strategy", values =c(my_orange, my_yellow, my_blue)) +
theme_bw() +
theme(axis.text.x = element_blank(), axis.text.y = element_text(size=20),axis.title = element_text(size=20), plot.title = element_text(size=20), legend.position = "none")+
labs(title= "A. Mean French exposure by strategy")
figure_10_b <- ggplot(her_for_anova_graphs, aes( x=strategy , y=eng_exp, fill = strategy )) +
stat_summary(geom="bar")+
stat_summary() +
ylim(0,100) +
scale_fill_manual (name = "Family Strategy", values =c(my_orange, my_yellow, my_blue)) +
theme_bw() +
theme(axis.text.x = element_blank(), axis.text.y = element_text(size=20),axis.title = element_text(size=20), plot.title = element_text(size=20), legend.position = "none")+
labs(title= "B. Mean English exposure by strategy")
figure_10_c <-ggplot(her_for_anova_graphs, aes( x=strategy , y=min_exp, fill = strategy )) +
stat_summary(geom="bar")+
stat_summary() +
ylim(0,100) +
scale_fill_manual (name = "Family Strategy", values =c(my_orange, my_yellow, my_blue)) +
theme_bw() +
theme(axis.text.x = element_blank(), axis.text.y = element_text(size=20),axis.title = element_text(size=20), plot.title = element_text(size=20), legend.text= element_text(size=20), legend.title= element_text(size=20))+
labs(title= "C. Mean heritage exposure by strategy")
figure_10<- figure_10_a + figure_10_b + figure_10_c
her_for_anovas<- FEH %>%
filter(!bilingual_type == "fre-eng") %>%
filter(!strategy == "single-parent") %>%
filter(!strategy == "one-language-at-home") %>%
mutate(strategy = case_when(strategy=="both-parents-bilingual"~"BothParentsBilingual",
strategy=="one-parent-bilingual"~"OneParentBilingual",
strategy=="one-parent-one-lang"~"OneParentOneLang"))
##French-Heritage Anova objects
her_anova_model_french <- aov(fre_exp ~ strategy, data= her_for_anovas)
her_anova_model_heritage <- aov(min_exp ~ strategy, data= her_for_anovas)
her_anova_model_english <- aov(eng_exp ~ strategy, data= her_for_anovas)
her_aov_fre<- tidy(her_anova_model_french)
her_aov_her<- tidy(her_anova_model_heritage)
her_aov_eng<- tidy(her_anova_model_english)
her_tukey_eng<- TukeyHSD (her_anova_model_english)
her_tukey_her<- TukeyHSD (her_anova_model_heritage)
# Create the dataframes to run the models for each language. Monolinguals are excluded, as are the rows
# where exposure for a given language equals 100. Since exposure is on a 0-100 scale and the beta distributions
# works with values ranging from 0-1, exposure is divided by 100.
for_beta <- FE_for_anovas %>%
select(gender, anon_baby_id, age, exp_l2, fre_exp, eng_exp, strategy, care1_l1, care1_l2, care2_l1, care2_l2, l1, l2) %>%
mutate(care1_l2 = case_when(care1_l2 =="NA" ~ "never",
TRUE ~ care1_l2)) %>%  #2023-07 going to need to fix this NAs in the cleaning script
mutate(care2_l1 = case_when(care2_l1 =="NA" ~ "never",
TRUE ~ care2_l1)) %>%
mutate(care2_l2 = case_when(care2_l2 =="NA" ~ "never",
TRUE ~ care2_l2)) %>%
mutate(caregiver_1_french_use = case_when(l1=="French"~care1_l1,
l2=="French"~care1_l2)) %>%
mutate(caregiver_1_english_use = case_when(l1=="English"~care1_l1,
l2=="English"~care1_l2)) %>%
mutate(caregiver_2_french_use = case_when(l1=="French"~ care2_l1,
l2=="French"~ care2_l2)) %>%
mutate(caregiver_2_english_use = case_when(l1=="English"~care2_l1,
l2=="English"~care2_l2)) %>%
filter(gender != "NA") %>%
filter(!strategy == "OneLanguageAtHome") %>%
mutate(fre_exp = fre_exp/100, eng_exp = eng_exp/100, exp_l2 = exp_l2/100) %>%
drop_na()
#Constructing the different beta models
#STRATEGY MODELS
strat_eng<- glmmTMB(eng_exp ~ strategy, data=for_beta, family= beta_family(link="logit"), dispformula = ~ strategy)
strat_fre <- glmmTMB(fre_exp ~ strategy, data=for_beta, family= beta_family(link="logit"), dispformula = ~ strategy)
#Summary of STRATEGY models
summary(strat_eng)
summary(strat_fre)
#MOTHER MODELS
mom_beta_eng<- glmmTMB(eng_exp ~ caregiver_1_english_use, data=for_beta, family= beta_family(link="logit"), dispformula = ~ caregiver_1_english_use)
mom_beta_fre<- glmmTMB(fre_exp ~ caregiver_1_french_use, data=for_beta, family= beta_family(link="logit"), dispformula = ~ caregiver_1_french_use)
#Summary of MOTHER models
summary(mom_beta_eng)
summary(mom_beta_fre)
#FATHER MODELS
dad_beta_eng<- glmmTMB(eng_exp ~ caregiver_2_english_use, data=for_beta, family= beta_family(link="logit"), dispformula = ~ caregiver_2_english_use)
dad_beta_fre<- glmmTMB(fre_exp ~ caregiver_2_french_use, data=for_beta, family= beta_family(link="logit"), dispformula = ~ caregiver_2_french_use)
#Summary of FATHER models
summary(dad_beta_eng)
summary(dad_beta_fre)
#MOTHER AND FATHER MODELS
parents_aditive_eng<- glmmTMB(eng_exp ~ caregiver_2_english_use + caregiver_1_english_use, data=for_beta, family= beta_family(link="logit"), dispformula = ~ caregiver_2_english_use + caregiver_1_english_use)
parents_aditive_fre<- glmmTMB(fre_exp ~ caregiver_2_french_use + caregiver_1_french_use, data=for_beta, family= beta_family(link="logit"), dispformula = ~ caregiver_2_french_use + caregiver_1_french_use)
#Summary of Mother and Father models
summary(parents_aditive_eng)
summary(parents_aditive_fre)
## MODEL COMPARISONS
#ENGLISH MODELS
test_performance(parents_aditive_eng, mom_beta_eng)
test_performance(parents_aditive_eng, dad_beta_eng)
#DHARMa::simulateLRT(mom_beta_eng, parents_aditive_eng, n=100) #aditive model is better
#FRENCH MODELS
test_performance(parents_aditive_fre, mom_beta_fre)
test_performance(parents_aditive_fre, dad_beta_fre)
performance::compare_performance(parents_aditive_fre, mom_beta_fre, dad_beta_fre)
#DHARMa::simulateLRT(mom_beta_fre, parents_aditive_fre, n=100)
summary(parents_aditive_fre)
summary(parents_aditive_eng)
##Notes by Nico: The dispersion model is not interpretable if the conditional model is not significative. If the dispersion model is significative the only thing it means is that the variance between predictors is different from eachother.
##Negative AIC is fine, it is interpreted as usual, the smaller the better
her_for_beta  <- her_for_anovas %>%
select(gender, anon_baby_id, age, exp_l2, min_exp,fre_exp, eng_exp, strategy, care1_l1, care1_l2, care2_l1, care2_l2, l1, l2) %>%
mutate(care1_l2 = case_when(care1_l2 =="NA" ~ "never",
TRUE ~ care1_l2)) %>%
mutate(care2_l1 = case_when(care2_l1 =="NA" ~ "never",
TRUE ~ care2_l1)) %>%
mutate(care2_l2 = case_when(care2_l2 =="NA" ~ "never",
TRUE ~ care2_l2))  %>%
mutate(caregiver_1_french_use = case_when(l1=="French"~care1_l1,
l2=="French"~care1_l2)) %>%
mutate(caregiver_1_heritage_use = case_when(l1=="Heritage"~care1_l1,
l2=="Heritage"~care1_l2)) %>%
mutate(caregiver_1_english_use = case_when(l1=="English"~care1_l1,
l2=="English"~care1_l2)) %>%
mutate(caregiver_2_french_use = case_when(l1=="French"~ care2_l1,
l2=="French"~ care2_l2)) %>%
mutate(caregiver_2_heritage_use = case_when(l1=="Heritage"~ care2_l1,
l2=="Heritage"~ care2_l2)) %>%
mutate(caregiver_2_english_use = case_when(l1=="English"~care2_l1,
l2=="English"~care2_l2)) %>%
filter(gender != "NA") %>%
filter(!strategy == "OneLanguageAtHome") %>%
mutate(fre_exp = fre_exp/100, eng_exp = eng_exp/100, min_exp = min_exp/100)
#Constructing the different beta models
#STRATEGY MODELS
her_strat_eng<- glmmTMB(eng_exp ~ strategy, data=her_for_beta, family= beta_family(link="logit"), dispformula = ~ strategy)
her_strat_fre <- glmmTMB(fre_exp ~ strategy, data=her_for_beta, family= beta_family(link="logit"), dispformula = ~ strategy)
her_strat_her <- glmmTMB(min_exp ~ strategy, data=her_for_beta, family= beta_family(link="logit"), dispformula = ~ strategy)
#Summary of STRATEGY models
summary(her_strat_eng)
summary(her_strat_fre)
summary(her_strat_her)
#MOTHER MODELS
her_mom_beta_eng<- glmmTMB(eng_exp ~ caregiver_1_english_use, data=her_for_beta, family= beta_family(link="logit"), dispformula = ~ caregiver_1_english_use)
her_mom_beta_fre<- glmmTMB(fre_exp ~ caregiver_1_french_use, data=her_for_beta, family= beta_family(link="logit"), dispformula = ~ caregiver_1_french_use)
her_mom_beta_her<- glmmTMB(min_exp ~ caregiver_1_heritage_use, data=her_for_beta, family= beta_family(link="logit"), dispformula = ~ caregiver_1_heritage_use)
#Summary of MOTHER models
summary(her_mom_beta_eng)
summary(her_mom_beta_fre)
summary(her_mom_beta_her)
#FATHER MODELS
her_dad_beta_eng<- glmmTMB(eng_exp ~ caregiver_2_english_use, data=her_for_beta, family= beta_family(link="logit"), dispformula = ~ caregiver_2_english_use)
her_dad_beta_fre<- glmmTMB(fre_exp ~ caregiver_2_french_use, data=her_for_beta, family= beta_family(link="logit"), dispformula = ~ caregiver_2_french_use)
her_dad_beta_her<- glmmTMB(min_exp ~ caregiver_2_heritage_use, data=her_for_beta, family= beta_family(link="logit"), dispformula = ~ caregiver_2_heritage_use)
#Summary of FATHER models
summary(dad_beta_eng)
summary(dad_beta_fre)
summary(her_dad_beta_her)
#MOTHER AND FATHER MODELS
her_parents_aditive_eng<- glmmTMB(eng_exp ~ caregiver_2_english_use + caregiver_1_english_use, data=her_for_beta, family= beta_family(link="logit"), dispformula = ~ caregiver_2_english_use + caregiver_1_english_use)
her_parents_aditive_fre<- glmmTMB(fre_exp ~ caregiver_2_french_use + caregiver_1_french_use, data=her_for_beta, family= beta_family(link="logit"), dispformula = ~ caregiver_2_french_use + caregiver_1_french_use)
her_parents_aditive_her<- glmmTMB(min_exp ~ caregiver_2_heritage_use + caregiver_1_french_use, data=her_for_beta, family= beta_family(link="logit"), dispformula = ~ caregiver_2_french_use + caregiver_1_heritage_use)
#Summary of Mother and Father models
summary(her_parents_aditive_eng)
summary(her_parents_aditive_fre)
summary(her_parents_aditive_her)
library(sjPlot)
library(sjlabelled)
library(sjmisc)
ov1_labels<- c("mother use sometimes", "mother use regularly", "father use sometimes", "father use regularly", "mother use sometimes", "mother use regularly","father use sometimes", "father use regularly")
ov1<- plot_models(lm_parents_aditive_eng, lm_parents_aditive_fre, show.values = TRUE, show.p = T, title = "A.Individual Parents' Contributions Model Estimates- French-English Sample", axis.labels = ov1_labels, axis.lim = c(-1,1), vline.color = "black", colors = c(my_blue, "red"), m.labels= c("Eng exp", "Fre exp"))+ theme_bw() +
theme(axis.text.y = element_text(size=13), axis.title.x = element_text(size=13), legend.text = element_text(size=13), legend.title = element_text(size=13))
ov2_labels<- c("mother use sometimes", "mother use regularly", "father use sometimes", "father use regularly", "mother use sometimes", "mother use regularly","father use sometimes", "father use regularly", "mother use sometimes", "mother use regularly","father use sometimes", "father use regularly")
ov2<- plot_models(her_lm_parents_aditive_eng, her_lm_parents_aditive_fre, her_lm_parents_aditive_her, show.values = T, show.p = T, title = "B.Individual Parents' Contributions Model Estimates- Heritage Sample", axis.labels = ov2_labels, axis.lim = c(-1,1), vline.color = "black", colors = c(my_green, my_blue, "red"), m.labels= c("Eng exp", "Fre exp", "Heritage exp"))+ theme_bw()+
theme(axis.text.y = element_text(size=13), axis.title.x = element_text(size=13), legend.text = element_text(size=13), legend.title = element_text(size=13))
other_visualization<- ov1+ov2
print(other_visualization)
## Extra code
######## FOR THE WHOLE SAMPLE ############
#Calculating how many families use each strategy and its corresponding %
prop_strategy<- first_visit_only %>%
group_by(strategy) %>%
tally() %>%
mutate(prop = n/sum(n)) %>%
mutate(perc= prop*100)
#Reordering levels so legend in the graph is in order.
prop_strategy$strategy<- factor(prop_strategy$strategy, levels= c("both-parents-bilingual", "one-parent-bilingual", "one-parent-one-lang", "one-language-at-home", "single-parent"))
prop_strategy<- prop_strategy %>%
arrange(desc(prop))
#Creating dataframes of each strategy to save their percentages and prnt them on the text
##Both parents bilingual
both_parents_biling<- prop_strategy %>%
filter(strategy=="both-parents-bilingual") %>%
select(perc)
perc_both_parents_biling<- round(both_parents_biling$perc, 1)
##One parent bilingual
one_parent_biling<- prop_strategy %>%
filter(strategy=="one-parent-bilingual") %>%
select(perc)
perc_one_parents_biling<- round(one_parent_biling$perc, 1)
##One parent one lang
one_parent_one_lang<- prop_strategy %>%
filter(strategy=="one-parent-one-lang") %>%
select(perc)
perc_one_parent_one_lang<- round(one_parent_biling$perc, 1)
##one language at home
one_language_at_home<- prop_strategy %>%
filter(strategy=="one-language-at-home") %>%
select(perc)
perc_one_language_at_home<- round(one_parent_biling$perc, 1)
#Waffle plot
V1<- setNames(prop_strategy$n, c("both-parents-bilingual", "one-parent-bilingual", "one-parent-one-lanaguage", "one-language-at-home", "single-parent"))
figure_1<- waffle(parts = V1, rows=20, colors = c(my_orange, my_yellow, my_blue, my_green, my_purple), keep = T, title = "Proportion of Use of Family Strategies", size=0.6)
#Making a figure of most used strategies divided by lang exposure
for_breakdown <- first_visit_only %>%
mutate(l1 = case_when(l1=="French" ~ "French",
l1=="English" ~ "English",
TRUE ~ "Heritage")) %>%
group_by(strategy, l1) %>%
tally() %>%
mutate(prop = n/sum(n)) %>%
mutate(perc= prop*100)
for_breakdown$strategy<- factor(for_breakdown$strategy, levels= c("both-parents-bilingual", "one-parent-bilingual", "one-parent-one-lang", "one-language-at-home", "single-parent"))
ggplot(for_breakdown, aes(x=l1, y=n, fill=strategy)) +
geom_bar(stat="identity", position="fill") +
scale_fill_manual (name = "Family Strategy", values =c(my_orange, my_yellow, my_blue, my_green, my_purple))
#collapse_rows_df <- function(df, variable){
#group_var <- enquo(variable)
#df %>%
# group_by(!! group_var) %>%
#mutate(groupRow = 1:n()) %>%
#ungroup() %>%
#mutate(!!quo_name(group_var) := ifelse(groupRow == 1, as.character(!! group_var), "")) %>%
#select(-c(groupRow))
#}
#strats_table<- final_data_strat %>%
# select(c(strategy, care1_l1, care1_l2, care2_l1, care2_l2))%>%
#rename(caregiver_A_L1 = care1_l1)%>%
#rename(caregiver_A_L2 = care1_l2)%>%
#rename(caregiver_B_L1 = care2_l1)%>%
#rename(caregiver_B_L2 = care2_l2)%>%
#arrange(strategy) %>%
#distinct() %>%
#collapse_rows_df(strategy)
#color_formatter <- formatter(
# "span",
#  style = x ~ style(
#   color = 'black',
#  'background-color' =
#   ifelse(x == "regularly", "#a1d76a", ifelse( x=="sometimes","#ffffbf", if_else(x=="never", "#e9a3c9", "white")))
#        ))
#formattable(strats_table,
#          list(
#           `caregiver_A_L1`= color_formatter,
#          `caregiver_A_L2`= color_formatter,
#         `caregiver_B_L1`= color_formatter,
#        `caregiver_B_L2`= color_formatter
#     )) %>%
#as.datatable(options = list(pageLength = 35)) %>%
#spk_add_deps() -> w
#htmlwidgets::saveWidget(w, "table.html", selfcontained = TRUE)
#webshot::webshot(url = "table.html", file = "table.png",
#              vwidth = 1200, vheight = 275)
FE_mother_long_analyses <- FE_long_analyses %>%
filter(!strategy=="single-parent") %>%
select(anon_baby_id, unique_id, l1, l2, care1_l1, care1_l2, visit, strategy, length_between_visits) %>%
mutate(caregiver_1_french_use = case_when(l1=="French"~care1_l1,
l2=="French"~care1_l2)) %>%
mutate(caregiver_1_english_use = case_when(l1=="English"~care1_l1,
l2=="English"~care1_l2)) %>%
mutate(individual_strategy_mother = case_when( caregiver_1_french_use %in% c("regularly", "sometimes") & caregiver_1_english_use %in% c("regularly", "sometimes") ~ "mother_bilingual" ,
TRUE ~ "mother_monolingual"
))
FE_father_long_analyses <- FE_long_analyses %>%
filter(!strategy=="single-parent") %>%
select(anon_baby_id, unique_id, l1, l2, care2_l1, care2_l2, visit, strategy, length_between_visits) %>%
mutate(caregiver_2_french_use = case_when(l1=="French"~ care2_l1,
l2=="French"~ care2_l2)) %>%
mutate(caregiver_2_english_use = case_when(l1=="English"~care2_l1,
l2=="English"~care2_l2)) %>%
mutate(individual_strategy_father = case_when( caregiver_2_french_use %in% c("regularly", "sometimes") & caregiver_2_english_use %in% c("regularly", "sometimes") ~ "father_bilingual" ,
TRUE ~ "father_monolingual"
))
FE_mother_father_long <- inner_join(FE_mother_long_analyses, FE_father_long_analyses)
FE_mother_father_long <- FE_mother_father_long %>%
select(anon_baby_id, visit, individual_strategy_mother, individual_strategy_father, strategy, length_between_visits) %>%
filter(visit == c(1,2)) %>%
mutate(visit = as.character(as.numeric(visit)))%>%
mutate(visit_a = visit) %>%#need two visit columns to give the df the appropriate shape for the sankey graph
mutate(visit_b= visit) %>%
pivot_wider(names_from = visit, values_from = strategy) %>%
rename("time_1_FLS" = "1") %>%
rename("time_2_FLS" = "2")
FE_mother_father_long <- FE_mother_father_long %>%
pivot_wider(names_from = visit_a, values_from = individual_strategy_mother) %>%
rename("time_1_Mom" = "1") %>%
rename("time_2_Mom" = "2")
FE_mother_father_long <- FE_mother_father_long %>%
pivot_wider(names_from = visit_b, values_from = individual_strategy_father) %>%
rename("time_1_Dad" = "1") %>%
rename("time_2_Dad" = "2")
FE_mother_father_long <- FE_mother_father_long %>%
group_by(anon_baby_id)%>%
summarise_all(na.omit) %>%#Collapsing IDs so that there is one row per baby cause otherwise the sankey wont work
ungroup()
##Make sankey graph
FE_mom_for_sankey <- FE_mother_father_long %>%
make_long("time_1_FLS","time_1_Mom", "time_2_Mom", "time_2_FLS")
FE_indi_mom_p1<- ggplot(FE_mom_for_sankey , aes(x = x,
next_x = next_x,
node = node,
next_node = next_node,
fill = factor(node), label=node)) +
geom_sankey(flow.color = "black") +
scale_fill_manual(name= "x", values = c(my_yellow,"#F66D7A","#8b2e57",my_green, my_blue, my_orange)) +
geom_sankey_label(size=5, color="black", fill="white")+
theme_bw()+
theme(legend.position = "none")
FE_dad_for_sankey <- FE_mother_father_long %>%
make_long("time_1_FLS","time_1_Dad", "time_2_Dad", "time_2_FLS")
FE_indi_dad_p1<- ggplot(FE_dad_for_sankey , aes(x = x,
next_x = next_x,
node = node,
next_node = next_node,
fill = factor(node), label=node)) +
geom_sankey(flow.color = "black") +
scale_fill_manual(name= "x", values = c(my_yellow,"#F66D7A","#8b2e57",my_green, my_blue, my_orange)) +
geom_sankey_label(size=5, color="black", fill="white")+
theme_bw()
unique(FEH$maternal_education)
FE_maternal_education <- FEH %>%
filter(bilingual_type=="fre-eng") %>%
group_by(strategy, maternal_education) %>%
drop_na(maternal_education) %>%
mutate(maternal_education = case_when(maternal_education %in% c("higschool", "less_than_highschool")~"highschool or less",
maternal_education %in% c("cgep", "university", "trade_school_diploma", "professional_degree") ~ "post-secondary education",
maternal_education %in% c("masters", "more_than_masters")~"post-graduate education")) %>%
tally()%>%
mutate(prop = n/sum(n)) %>%
mutate(perc= prop*100)
sup_figure_1<- ggplot(FE_maternal_education, aes(y=perc, x=strategy, fill=maternal_education)) +
geom_col(position = "fill") +
scale_fill_brewer(palette="Dark2")+
labs(title= "French-English sample maternal education by strategy")+
theme(axis.text.x = element_text(angle = 25))
sup_figure_1
FE_maternal_education <- FEH %>%
filter(bilingual_type=="fre-eng") %>%
group_by(strategy, maternal_education) %>%
drop_na(maternal_education)
unique(FE_maternal_education$maternal_education)
FE_maternal_education <- FEH %>%
filter(bilingual_type=="fre-eng") %>%
group_by(strategy, maternal_education) %>%
drop_na(maternal_education)%>%
mutate(maternal_education = case_when(maternal_education %in% c("higschool", "less_than_highschool")~"highschool or less",
maternal_education %in% c("cgep", "university", "trade_school_diploma", "professional_degree") ~ "post-secondary education",
maternal_education %in% c("masters", "more_than_masters")~"post-graduate education"))
unique(FE_maternal_education$maternal_education)
FE_maternal_education <- FEH %>%
filter(bilingual_type=="fre-eng") %>%
group_by(strategy, maternal_education) %>%
drop_na(maternal_education)%>%
mutate(maternal_education = case_when(maternal_education %in% c("highschool", "less_than_highschool")~"highschool or less",
maternal_education %in% c("cgep", "university", "trade_school_diploma", "professional_degree") ~ "post-secondary education",
maternal_education %in% c("masters", "more_than_masters")~"post-graduate education")) %>%
tally()%>%
mutate(prop = n/sum(n)) %>%
mutate(perc= prop*100)
sup_figure_1<- ggplot(FE_maternal_education, aes(y=perc, x=strategy, fill=maternal_education)) +
geom_col(position = "fill") +
scale_fill_brewer(palette="Dark2")+
labs(title= "French-English sample maternal education by strategy")+
theme(axis.text.x = element_text(angle = 25))
sup_figure_1
FE_maternal_education <- FEH %>%
filter(bilingual_type=="fre-eng") %>%
filter(!strategy == "single_parent")%>%
drop_na(strategy)%>%
group_by(strategy, maternal_education) %>%
drop_na(maternal_education)%>%
mutate(maternal_education = case_when(maternal_education %in% c("highschool", "less_than_highschool")~"highschool or less",
maternal_education %in% c("cgep", "university", "trade_school_diploma", "professional_degree") ~ "post-secondary education",
maternal_education %in% c("masters", "more_than_masters")~"post-graduate education")) %>%
tally()%>%
mutate(prop = n/sum(n)) %>%
mutate(perc= prop*100)
sup_figure_1<- ggplot(FE_maternal_education, aes(y=perc, x=strategy, fill=maternal_education)) +
geom_col(position = "fill") +
scale_fill_brewer(palette="Dark2")+
labs(title= "French-English sample maternal education by strategy")+
theme(axis.text.x = element_text(angle = 25))
sup_figure_1
FE_maternal_education <- FEH %>%
filter(bilingual_type=="fre-eng") %>%
filter(!strategy == "single-parent")%>%
drop_na(strategy)%>%
group_by(strategy, maternal_education) %>%
drop_na(maternal_education)%>%
mutate(maternal_education = case_when(maternal_education %in% c("highschool", "less_than_highschool")~"highschool or less",
maternal_education %in% c("cgep", "university", "trade_school_diploma", "professional_degree") ~ "post-secondary education",
maternal_education %in% c("masters", "more_than_masters")~"post-graduate education")) %>%
tally()%>%
mutate(prop = n/sum(n)) %>%
mutate(perc= prop*100)
sup_figure_1<- ggplot(FE_maternal_education, aes(y=perc, x=strategy, fill=maternal_education)) +
geom_col(position = "fill") +
scale_fill_brewer(palette="Dark2")+
labs(title= "French-English sample maternal education by strategy")+
theme(axis.text.x = element_text(angle = 25))
sup_figure_1
FE_maternal_education$maternal_education<- factor(FE_maternal_education$maternal_education, levels= c("highschool or less", "post-secondary education", "post-graduate education"))
sup_figure_1<- ggplot(FE_maternal_education, aes(y=perc, x=strategy, fill=maternal_education)) +
geom_col(position = "fill") +
scale_fill_brewer(palette="Dark2")+
labs(title= "French-English sample maternal education by strategy")+
theme(axis.text.x = element_text(angle = 25))
sup_figure_1
FE_maternal_education$maternal_education <- factor(FE_maternal_education$maternal_education, levels= c("post-graduate education", "post-secondary education", "highschool or less"))
sup_figure_1<- ggplot(FE_maternal_education, aes(y=perc, x=strategy, fill=maternal_education)) +
geom_col(position = "fill") +
scale_fill_brewer(palette="Dark2")+
labs(title= "French-English sample maternal education by strategy")+
theme(axis.text.x = element_text(angle = 25))
sup_figure_1
HER_maternal_education <- FEH %>%
filter(bilingual_type %in% c("fre-her", "eng-her")) %>%
filter(!strategy == "single-parent")%>%
drop_na(strategy)%>%
group_by(strategy, maternal_education) %>%
drop_na(maternal_education) %>%
mutate(maternal_education = case_when(maternal_education %in% c("highschool", "less_than_highschool")~"highschool or less",
maternal_education %in% c("cgep", "university", "trade_school_diploma", "professional_degree") ~ "post-secondary education",
maternal_education %in% c("masters", "more_than_masters")~"post-graduate education")) %>%
tally()%>%
mutate(prop = n/sum(n)) %>%
mutate(perc= prop*100)
HER_maternal_education$maternal_education <- factor(FE_maternal_education$maternal_education, levels= c("post-graduate education", "post-secondary education", "highschool or less"))
unique(HER_maternal_education$maternal_education)
HER_maternal_education$maternal_education <- factor(HER_maternal_education$maternal_education, levels=c("post-graduate education", "post-secondary education", "highschool or less"))
sup_figure_2<- ggplot(HER_maternal_education, aes(y=perc, x=strategy, fill=maternal_education)) +
geom_col(position = "fill") +
scale_fill_brewer(palette="Dark2") +
labs(title= "Heritage sample maternal education by strategy")+
theme(axis.text.x = element_text(angle = 25))
sup_figure_2
FE_paternal_education <- FEH %>%
filter(bilingual_type=="fre-eng") %>%
filter(!strategy == "single-parent")%>%
drop_na(strategy)%>%
group_by(strategy, paternal_education) %>%
drop_na(paternal_education) %>%
mutate(paternal_education = case_when(paternal_education %in% c("highschool", "less_than_highschool")~"highschool or less",
paternal_education %in% c("cgep", "university", "trade_school_diploma", "professional_degree") ~ "post-secondary education",
paternal_education %in% c("masters", "more_than_masters")~"post-graduate education")) %>%
tally()%>%
mutate(prop = n/sum(n)) %>%
mutate(perc= prop*100)
FE_paternal_education$paternal_education <- factor(FE_paternal_education$paternal_education, levels=c("post-graduate education", "post-secondary education", "highschool or less"))
sup_figure_3<- ggplot(FE_paternal_education, aes(y=perc, x=strategy, fill=paternal_education)) +
geom_col(position = "fill")  +
scale_fill_brewer(palette="Dark2") +
labs(title= "French-English sample paternal education by strategy")+
theme(axis.text.x = element_text(angle = 25))
sup_figure_3
HER_paternal_education <- FEH %>%
filter(bilingual_type %in% c("fre-her", "eng-her")) %>%
filter(bilingual_type=="fre-eng") %>%
filter(!strategy == "single-parent")%>%
group_by(strategy, paternal_education) %>%
drop_na(paternal_education) %>%
mutate(paternal_education = case_when(paternal_education %in% c("highschool", "less_than_highschool")~"highschool or less",
paternal_education %in% c("cgep", "university", "trade_school_diploma", "professional_degree") ~ "post-secondary education",
paternal_education %in% c("masters", "more_than_masters")~"post-graduate education")) %>%
tally()%>%
mutate(prop = n/sum(n)) %>%
mutate(perc= prop*100)
HER_paternal_education$paternal_education <- factor(HER_paternal_education$paternal_education, levels=c("post-graduate education", "post-secondary education", "highschool or less"))
sup_figure_4<- ggplot(HER_paternal_education, aes(y=perc, x=strategy, fill=paternal_education)) +
geom_col(position = "fill")+
scale_fill_brewer(palette="Dark2") +
labs(title= "Heritage sample paternal education by strategy")+
theme(axis.text.x = element_text(angle = 25))
sup_figure_4
HER_paternal_education <- FEH %>%
filter(bilingual_type %in% c("fre-her", "eng-her")) %>%
filter(!strategy == "single-parent")%>%
group_by(strategy, paternal_education) %>%
drop_na(paternal_education) %>%
mutate(paternal_education = case_when(paternal_education %in% c("highschool", "less_than_highschool")~"highschool or less",
paternal_education %in% c("cgep", "university", "trade_school_diploma", "professional_degree") ~ "post-secondary education",
paternal_education %in% c("masters", "more_than_masters")~"post-graduate education")) %>%
tally()%>%
mutate(prop = n/sum(n)) %>%
mutate(perc= prop*100)
HER_paternal_education$paternal_education <- factor(HER_paternal_education$paternal_education, levels=c("post-graduate education", "post-secondary education", "highschool or less"))
sup_figure_4<- ggplot(HER_paternal_education, aes(y=perc, x=strategy, fill=paternal_education)) +
geom_col(position = "fill")+
scale_fill_brewer(palette="Dark2") +
labs(title= "Heritage sample paternal education by strategy")+
theme(axis.text.x = element_text(angle = 25))
sup_figure_4
sup_figure_2
