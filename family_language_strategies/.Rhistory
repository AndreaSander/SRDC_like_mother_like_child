rename("Fre" = caregiver_2_french_use,
"Eng" = caregiver_2_english_use) %>%
select(-care2_l1, -care2_l2, -l1, -l2) %>%
pivot_wider(names_from = visit, values_from = c(Fre, Eng)) %>%
rename_at(vars(starts_with("Fre")), ~ paste0(str_remove(., "Fre_"), "_Fre")) %>%
rename_at(vars(starts_with("Eng")), ~  paste0(str_remove(., "Eng_"), "_Eng")) %>%
drop_na()
dad_long_french<- dad_long %>%
select(anon_baby_id, length_between_visits, time_1_Fre, time_2_Fre) %>%
mutate(time_1_Fre = case_when(time_1_Fre == "NA"~"never",
TRUE~ Visit_1_Fre))
dad_long_french<- dad_long %>%
select(anon_baby_id, length_between_visits, time_1_Fre, time_2_Fre) %>%
mutate(time_1_Fre = case_when(time_1_Fre == "NA"~"never",
TRUE~ time_1_Fre))
dad_long_english<- dad_long %>%
select(anon_baby_id, length_between_visits, time_1_Eng, time_2_Eng)
dad_long_fre_s <- dad_long_french %>%
make_long("time_1_Fre","time_2_Fre")
dad_long_fre_s$node <- factor(dad_long_fre_s$node, levels= c("never","sometimes", "regularly"))
dad_long_fre_s$next_node <- factor(dad_long_fre_s$next_node, levels= c("never","sometimes","regularly"))
dad_long_eng_s <- dad_long_english %>%
make_long("time_1_Eng", "time_2_Eng")
dad_long_eng_s$node <- factor(dad_long_eng_s$node, levels= c("never","sometimes", "regularly"))
dad_long_eng_s$next_node <- factor(dad_long_eng_s$next_node, levels= c("never","sometimes","regularly"))
v1_dad_prop_fre <- dad_long %>%
select(time_1_Fre, time_1_Eng) %>%
group_by(time_1_Fre) %>%
tally(name = "n_first_visit")%>%
mutate(proportion_first_visit = n_first_visit/sum(n_first_visit)) %>%
mutate(percentage_first_visit= proportion_first_visit*100)
v2_dad_prop_fre <- dad_long %>%
select(time_2_Fre, time_2_Eng) %>%
group_by(time_2_Fre) %>%
tally(name = "n_first_visit")%>%
mutate(proportion_first_visit = n_first_visit/sum(n_first_visit)) %>%
mutate(percentage_first_visit= proportion_first_visit*100)
v1_dad_prop_eng <- dad_long %>%
select(time_1_Fre, time_1_Eng) %>%
group_by(time_1_Eng) %>%
tally(name = "n_first_visit")%>%
mutate(proportion_first_visit = n_first_visit/sum(n_first_visit)) %>%
mutate(percentage_first_visit= proportion_first_visit*100)
v2_dad_prop_eng <- dad_long %>%
select(time_2_Fre, time_2_Eng) %>%
group_by(time_2_Eng) %>%
tally(name = "n_first_visit")%>%
mutate(proportion_first_visit = n_first_visit/sum(n_first_visit)) %>%
mutate(percentage_first_visit= proportion_first_visit*100)
figure_4_a <- ggplot(dad_long_fre_s , aes(x = x,
next_x = next_x,
node = node,
next_node = next_node,
fill = factor(node), label=node)) +
geom_sankey(flow.color = "black") +
scale_fill_manual(values = c("#dac291","#41ae76", "#75638b"))+
geom_sankey_label(size=10, color="black", fill="white")+
theme_bw()+
theme(axis.text.x = element_text(size=30), legend.position = "none", plot.title = element_text(size=35))+
labs(title= "A. Fathers' change of language use French")
figure_4_b <- ggplot(dad_long_eng_s , aes(x = x,
next_x = next_x,
node = node,
next_node = next_node,
fill = factor(node), label=node)) +
geom_sankey(flow.color = "black") +
scale_fill_manual(values =c("#dac291","#41ae76", "#75638b"))+
geom_sankey_label(size=10, color="black", fill="white")+
theme_bw()+
theme(axis.text.x = element_text(size=30), legend.position = "none", plot.title = element_text(size=35))+
labs(title= "B. Fathers' change of language use English")
figure_4<- figure_4_a + figure_4_b
ggsave(file="Figure_4.png", width=25, height=12, dpi=300)
figure_2<- figure_2 +
geom_sankey_label(size=10, color="black", fill="white")+
theme_bw()+
theme(axis.text.x = element_text(c("time 1", "time 2"), size=35),axis.title = element_text(size=25), plot.title = element_text(size=25), legend.position = "none", axis.ticks = element_blank(), axis.text.y = element_blank())
print(figure_2)
figure_1<- waffle(parts = V1_FE, rows=13, colors = c(my_orange, my_yellow, my_blue, my_green, my_purple), keep = T, size=0.6)+
theme(legend.text= element_text(size=12),legend.title= element_text(size=12))
ggsave(file="Figure_1.png", width=25, height=7, dpi=300)
knitr::opts_chunk$set(echo = TRUE)
load(here("anonymized_data/SES_and_ethicity_info.xlsx"))
library(here)
library(tidyverse)
library(lubridate)
library(broom)
library(janitor)
library(knitr)
library(patchwork)
load(here("anonymized_data/LEQ_data.Rda"))
load(here("anonymized_data/demographic_data.Rda"))
load(here("anonymized_data/SES_and_ethicity_info.xlsx"))
library(readxl)
readxl::read_xlsx("anonymized_data/SES_and_ethicity_info.xlsx"))
readxl::read_xlsx("anonymized_data/SES_and_ethicity_info.xlsx")
SES_info<- readxl::read_xlsx("anonymized_data/SES_and_ethicity_info.xlsx")
View(SES_info)
SES_info %>%
group_by(maternal_education) %>%
tally()
SES_info %>%
group_by(maternal_education) %>%
tally()%>%
mutate(prop = n/sum(n))
#gets gender under a unified scale, as it had different scales for different studies
demographic_data <- demographic_data %>%
mutate(gender=case_when(
gender %in% c("male", "M") ~ "male",
gender %in% c("female", "F") ~ "female",
gender == 1 ~ "male",
gender == 0 ~ "female"))
load(here("anonymized_data/LEQ_data.Rda"))
load(here("anonymized_data/demographic_data.Rda"))
SES_info<- readxl::read_xlsx("anonymized_data/SES_and_ethicity_info.xlsx")
#rename
LEQ_data <- final_fam_str
demographic_data <- demog_anonym
#gets gender under a unified scale, as it had different scales for different studies
demographic_data <- demographic_data %>%
mutate(gender=case_when(
gender %in% c("male", "M") ~ "male",
gender %in% c("female", "F") ~ "female",
gender == 1 ~ "male",
gender == 0 ~ "female"))
#renames studies to make paralell to the way they are named in the LEQ data.
demographic_data <- demographic_data %>%
mutate(study = tolower(study)) %>%
mutate(study = case_when(study =="cogmisp" ~ "cogmisp24",
study=="faceprince-12"~"faceprince12",
study=="faceprince-18"~"faceprince18",
study=="littlemix-8"~"littlemix8",
study=="many_babies_12"~"manybabies12",
study=="many_babies_6"~"manybabies6",
study=="segment_8"~"segment8",
TRUE ~ study)) %>%
mutate(unique_id = paste(anon_baby_id, study, sep="_")) #creates a unique identifier per each baby per each study
#gets rid of duplicated demographic data
demographic_data <- demographic_data %>%
group_by(unique_id) %>%
#then slice just the final row for each group. If there is only 1 row for an ID, it takes that one. If there are multiples, it keeps the last one. Usually I use slice_head(), keeping the first row instead of the last row, but one ID in this dataset has NA for gender in one instance but has gender in its duplicate, so we'll keep the row with more info
slice_tail(n = 1) %>%
#finally, ungroup the dataset:
ungroup()
#adding unique identifier to LEQ data
LEQ_data <-
LEQ_data %>%
mutate(study = tolower(study)) %>%
mutate(unique_id = paste(anon_baby_id, study, sep="_"))
final_data <-
right_join(demographic_data, LEQ_data ,  by= c("unique_id", "study", "anon_baby_id"))
View(final_data)
#clean date of birth error in one participant
final_data <- final_data %>%
mutate(leq_date = as.character(leq_date))
final_data$leq_date[final_data$leq_date== "2016-08-07"] <- "2017-03-28"
View(SES_info)
head(SES_info)
SES_info<- readxl::read_xlsx("anonymized_data/SES_and_ethicity_info.xlsx") %>%
select(-c("...8", "...9 "))
SES_info<- readxl::read_xlsx("anonymized_data/SES_and_ethicity_info.xlsx") %>%
select(-c(...8, ...9))
View(SES_info)
final_data_test %>% final_data %>%
right_join(SES_info, final_data, by=c("unique_id", "study", "anon_baby_id"))
final_data_test <- final_data %>%
right_join(SES_info, final_data, by=c("unique_id", "study", "anon_baby_id"))
View(final_data_test)
final_data$do_birth<-as.Date(as.character(final_data$do_birth))
final_data$leq_date<-as.Date(as.character(final_data$leq_date))
final_data <- final_data %>%
mutate(age= interval(start= do_birth, end=leq_date)/
duration(n=1, unit="months"))
#Create a type of family column. NOTE this column was created after thoroughly reviewing parents' answers and it reflects the places where it was explicitly noted that a child had two same-gender caregivers, or where it is obvious by the parents answers that the child has a single caregiver. Otherwise it was assumed that the child had a mother and a father, and that mothers' answers were entered in the caregiver 1 slot, as it is explicitly instructed in the questionnaire.
final_data <- final_data %>%
mutate (type_of_family= case_when(anon_baby_id == 5815080 ~ "same_sex_parents",
anon_baby_id == 5373360 ~ "same_sex_parents",
care1_l1 %in% c("never", "NA") & care1_l2 %in% c("never", "NA") & care1_l3 %in% c("never", "NA") & care1_l4 %in% c("never", "NA") ~ "single-parent",
care2_l1 %in% c("never", "NA") & care2_l2 %in% c("never", "NA") & care2_l3 %in% c("never", "NA") & care2_l4 %in% c("never", "NA") ~ "single-parent",
TRUE ~ "mother-father family"))
#save data before exclusions
final_data_no_exc<- final_data
save(final_data_no_exc, file=here("anonymized_data/final_data_no_exc.Rda"))
final_data <- final_data %>%
group_by(unique_id, exp_l1, exp_l2)%>%
mutate(total_l1_l2_exp=(sum(exp_l1,exp_l2,na.rm = T))) %>%
ungroup() %>%
filter(total_l1_l2_exp>=90) #59 exclusions for more than 10% exposure to a third language
save(final_data, file=here("anonymized_data/final_merged_data.Rda"))
##NOTE: Originally I had also added exposure on language 3 and 4. Language 3 and 4 always amount to less than 10% because we excluded trilinguals. However,
#in parental interviews caregivers frequently give a third language and the final calculation is so low it amounts to 0
#this was 0 inflating our english and french exposures, and because we are interested in how bilingual strategies relate to bilingual exposure, I decided to get rid of l3 and 4 exposure when making the french, english, and heritage language exposure variables.
vars<-c("exp_l3", "exp_l4")
final_data <-
final_data %>%
mutate_at(vars, as.numeric) %>%
mutate(l3 = replace(l3, l3=="NA", "no lang")) %>%
mutate(l4 = replace(l4, l4=="NA", "no lang")) %>%
mutate(fre_exp = case_when(l1=="French"~ exp_l1,
l2=="French"~ exp_l2,
#l3=="French" & exp_l3 >=1 ~ exp_l3,
#l4=="French"  & exp_l4 >=1 ~ exp_l4
))%>%
mutate(eng_exp = case_when(l1=="English"~ exp_l1,
l2=="English"~ exp_l2,
#l3=="English"~ exp_l3,
#l4=="English"~ exp_l4
)) %>%
mutate(min_exp = case_when (!(l1 %in% c("French", "English"))& l2 %in% c("French", "English") ~ exp_l1,
!(l2 %in% c("French", "English")) & l1 %in% c("French", "English") ~ exp_l2
))
final_data_strat <- final_data %>%
mutate(strategy=case_when(
#one-parent-one-lang-strict: Each parent speaks only one language and both parents don't speak the same language
care1_l1=="regularly" & care1_l2 %in% c("never", "NA") & care2_l1 %in% c("never", "NA") & care2_l2=="regularly"~ "one-parent-one-lang",
care1_l1 %in% c("never", "NA") & care1_l2=="regularly" & care2_l1=="regularly" & care2_l2 %in% c("never", "NA")~ "one-parent-one-lang",
#one-parent-one-lang-flex: Each parent speaks mainly one language, and one of them sometimes speaks another language
#(The same language cannot be spoken regularly by both parents or that would be considered a one-parent-bilingual strategy)
#**NOTE: we ended up having a single category for OPOL instead of divinding it into strict and flex.
care1_l1=="regularly" & care1_l2 %in% c("never", "NA") & care2_l1=="sometimes" &care2_l2=="regularly"~ "one-parent-one-lang",
care1_l1=="regularly" & care1_l2=="sometimes" & care2_l1 %in% c("never", "NA") &care2_l2=="regularly"~ "one-parent-one-lang",
care1_l1=="sometimes" & care1_l2=="regularly" & care2_l1=="regularly" &care2_l2 %in% c("never", "NA")~ "one-parent-one-lang",
care1_l1 %in% c("never", "NA") & care1_l2=="regularly" & care2_l1=="regularly" &care2_l2=="sometimes"~ "one-parent-one-lang",
#one-parent-bilingual: One parent speaks 2 languages, the other parent only speaks one language
#Starting point
care1_l1== "regularly" & care1_l2=="regularly" & care2_l1 == "regularly" & care2_l2 %in% c("never", "NA") ~ "one-parent-bilingual",
care1_l1== "regularly" & care1_l2=="regularly" & care2_l1 %in% c("never", "NA") & care2_l2=="regularly" ~ "one-parent-bilingual",
care1_l1== "regularly" & care1_l2 %in% c("never", "NA") & care2_l1 == "regularly" & care2_l2=="regularly" ~ "one-parent-bilingual",
care1_l1 %in% c("never", "NA") & care1_l2=="regularly" & care2_l1 == "regularly" & care2_l2=="regularly" ~ "one-parent-bilingual",
#Some bilingual parents put both of their languages as sometimes rather than both as regularly
care1_l1== "sometimes" & care1_l2=="sometimes" & care2_l1 == "regularly" & care2_l2 %in% c("never", "NA") ~ "one-parent-bilingual",
care1_l1== "sometimes" & care1_l2=="sometimes" & care2_l1 %in% c("never", "NA") & care2_l2=="regularly" ~ "one-parent-bilingual",
care1_l1== "regularly" & care1_l2 %in% c("never", "NA") & care2_l1 == "sometimes" & care2_l2=="sometimes" ~ "one-parent-bilingual",
care1_l1 %in% c("never", "NA") & care1_l2=="regularly" & care2_l1 == "sometimes" & care2_l2=="sometimes" ~ "one-parent-bilingual",
#One parent bilingual (R&R or S&S) and another parent that speaks one of the language but not the other (R|S & N|NA)
care1_l1 == "regularly" & care1_l2=="regularly" & care2_l1 %in% c("regularly", "sometimes") & care2_l2 %in% c("never", "NA") ~ "one-parent-bilingual",
care1_l1 == "regularly" & care1_l2=="regularly" & care2_l1 %in% c("never", "NA") & care2_l2 %in% c("regularly", "sometimes") ~ "one-parent-bilingual",
care1_l1 %in% c("regularly", "sometimes") & care1_l2 %in% c("never", "NA") & care2_l1 == "regularly" & care2_l2=="regularly" ~ "one-parent-bilingual",
care1_l1 %in% c("never", "NA") & care1_l2 %in% c("regularly", "sometimes") & care2_l1 == "regularly" & care2_l2=="regularly" ~ "one-parent-bilingual",
care1_l1 == "sometimes" & care1_l2=="sometimes" & care2_l1 %in% c("regularly", "sometimes") & care2_l2 %in% c("never", "NA") ~ "one-parent-bilingual",
care1_l1 == "sometimes" & care1_l2=="sometimes" & care2_l1 %in% c("never", "NA") & care2_l2 %in% c("regularly", "sometimes") ~ "one-parent-bilingual",
care1_l1 %in% c("regularly", "sometimes") & care1_l2 %in% c("never", "NA") & care2_l1 == "sometimes" & care2_l2=="sometimes" ~ "one-parent-bilingual",
care1_l1 %in% c("never", "NA") & care1_l2 %in% c("regularly", "sometimes") & care2_l1 == "sometimes" & care2_l2=="sometimes" ~ "one-parent-bilingual",
#Both parents speak the same language regularly, and one of them speak another language sometimes
#(not one-parent-one-lang-flex because both parents use the same language regularly in opposition to each parent having a different language that they use regularly)
care1_l1=="regularly" & care1_l2=="sometimes" & care2_l1=="regularly" & care2_l2 %in% c("never", "NA") ~ "one-parent-bilingual",
care1_l1=="regularly" & care1_l2 %in% c("never", "NA") & care2_l1=="regularly" & care2_l2=="sometimes" ~ "one-parent-bilingual",
care1_l1=="sometimes" & care1_l2=="regularly" & care2_l1 %in% c("never", "NA")& care2_l2=="regularly" ~ "one-parent-bilingual",
care1_l1 %in% c("never", "NA") & care1_l2=="regularly" & care2_l1=="sometimes" & care2_l2=="regularly" ~ "one-parent-bilingual",
#both-parents-bilingual: Both parents speak both languages either regularly or sometimes
care1_l1%in% c("regularly", "sometimes") & care1_l2%in% c("regularly", "sometimes") & care2_l1%in% c("regularly", "sometimes") &care2_l2%in% c("regularly", "sometimes") ~ "both-parents-bilingual",
#one-language-at-home: There is only one language spoken in the home by both parents
care1_l1=="regularly" & care1_l2 %in% c("never", "NA") & care2_l1=="regularly" &care2_l2 %in% c("never", "NA")~ "one-language-at-home",
care1_l1 %in% c("never", "NA") & care1_l2=="regularly" & care2_l1 %in% c("never", "NA") & care2_l2=="regularly"~ "one-language-at-home",
care1_l1=="sometimes" & care1_l2 %in% c("never", "NA") & care2_l1=="sometimes" &care2_l2 %in% c("never", "NA")~ "one-language-at-home",
care1_l1 %in% c("never", "NA") & care1_l2=="sometimes" & care2_l1 %in% c("never", "NA") & care2_l2=="sometimes"~ "one-language-at-home",
#single-parent: Family in which there is only one caregiver
care1_l1 %in% c("never", "NA") & care1_l2 %in% c("never", "NA") & care1_l3 %in% c("never", "NA") & care1_l4 %in% c("never", "NA") ~ "single-parent",
care2_l1 %in% c("never", "NA") & care2_l2 %in% c("never", "NA") & care2_l3 %in% c("never", "NA") & care2_l4 %in% c("never", "NA") ~ "single-parent"
))
# I decided to exclude "true" monolinguals characterized here to the best of our abilities as children whose families use one language at home strategy, and the childcare language is the same as the one language at home strategy = they are being exposed to a single language = most likely not a bilingual strategy.
final_data_strat <-
final_data_strat %>%
mutate(bilinugal_strategy= case_when(strategy=="one-language-at-home" & childcare_l1 == l1 & childcare_l2 %in% c(NA, "NA")  ~ "no",
strategy=="one-language-at-home" & childcare_l2 == l1 & childcare_l1 %in% c(NA, "NA") ~"no",
strategy=="one-language-at-home" & childcare_l1 %in% c(NA, "NA") & childcare_l2 %in% c(NA, "NA") ~"no",
TRUE~"yes")) %>%
filter(bilinugal_strategy=="yes")
#In the end, after discussion we decided to filter all the strictly monolinguals because we are truly interested in bilinguals mainly.
final_data_strat <-
final_data_strat %>%
filter(exp_l1 <95) %>%
filter(exp_l2 >5)
save(final_data_strat, file=here("anonymized_data/final_data_strat.Rda"))
knitr::opts_chunk$set(echo = TRUE)
options(scipen = 100, digits = 4)
library(lubridate)
library(sparkline)
library(webshot)
library(htmlwidgets)
library(formattable)
library(here)
library(lme4)
library(lmerTest)
library(rstatix)
library(papeR)
library(knitr)
library(waffle)
library(ggsankey)
library(dplyr)
library(tidyverse)
library(patchwork)
library(ggpubr)
library(broom)
library(janitor)
library(glmmTMB)
library(DHARMa)
library(betareg)
library(emmeans)
library(ggiraphExtra)
library(ggeffects)
library(mvtnorm)
library(boot)
library(bbmle)
library(performance)
library(see)
library(writexl)
load(here("anonymized_data/final_merged_data.Rda"))
load(here("anonymized_data/final_data_no_exc.Rda"))
load(here("anonymized_data/final_data_strat.Rda"))
load(here("anonymized_data/longitudinal_data.Rda"))
SES_info<- readxl::read_xlsx("anonymized_data/SES_and_ethicity_info.xlsx") %>%
select(-c(...8, ...9))
#Saving my palette to use in visualizations
my_yellow<-"#FFC107"
my_orange<- "#D95F02"
my_blue<- "#1F78B4"
my_green<- "#33a02c"
my_purple<- "#683f6d"
#### CONSTRUCTING AND DESCRIBING ALL RELEVANT DATA SETS ####
#Trilingul exclusions count
total_excluded_triling<- final_data_no_exc %>%
group_by(unique_id, exp_l1, exp_l2)%>%
mutate(total_l1_l2_exp=(sum(exp_l1,exp_l2,na.rm = T))) %>%
ungroup() %>%
filter(total_l1_l2_exp<=90) %>%
distinct(unique_id)%>%
tally()
#Monolingual exclusions
total_monoling_excluded<- final_data_no_exc %>%
filter(exp_l1 >95) %>%
filter(exp_l2 <5) %>%
distinct(unique_id) %>%
tally()
#after third language exclusions exclusions
n <- final_data_strat %>%
distinct(unique_id) %>%
tally()
#subseting to get data only from each child's first visit to the lab. For main analyses
first_visit_only <- final_data_strat%>%
arrange(anon_baby_id, age) %>%
group_by(anon_baby_id) %>%
mutate(visit = row_number()) %>%
ungroup() %>%
filter(visit==1)
#n when only taking first visit
n_keep_first_visit<-first_visit_only %>%
distinct(anon_baby_id)%>%
tally()
age_min <- round(min(first_visit_only$age, na.rm = T), 2)
age_max<- round(max(first_visit_only$age, na.rm = T), 2)
age_mean<- round(mean(first_visit_only$age, na.rm = T), 2)
age_sd<- round(sd(first_visit_only$age, na.rm = T), 2)
female<- first_visit_only %>%
filter(gender=="female")%>%
distinct(anon_baby_id)%>% #using anon_baby_id since it uniquely identifies individual babies, instead of identifying by study
tally()
num_visits <- final_data_strat %>%
count(anon_baby_id, name = "n_visits") %>%
count(n_visits, name = "n_families")  %>%
mutate(n_data_points = n_families* n_visits)
#French-English-Heritage bilingual percentages
FEH <- first_visit_only %>%
mutate(l1 = case_when(l1=="French" ~ "French",
l1=="English" ~ "English",
TRUE ~ "Heritage")) %>%
mutate(l2 = case_when(l2=="French" ~ "French",
l2=="English" ~ "English",
TRUE ~ "Heritage")) %>%
mutate(bilingual_type = case_when(l1 %in% c("French", "English") & l2 %in% c("French", "English") ~ "fre-eng",
l1 %in% c("French", "Heritage") & l2 %in% c("French", "Heritage") ~ "fre-her",
l1 %in% c("Heritage", "English") & l2 %in% c("Heritage", "English") ~ "eng-her"))
#Exporting the final data set that we used in all analyses and visualizations
#write_xlsx(FEH,"anonymized_data\\fam_Str_cross_sectional.xlsx")
FEH_perc<- FEH %>%
group_by(bilingual_type) %>%
tally()%>%
mutate(prop = n/sum(n)) %>%
mutate(perc= prop*100)
#By bilingual type percentages
fre_eng_perc <- FEH %>%
filter(bilingual_type== "fre-eng")%>%
group_by(l1) %>%
tally()%>%
mutate(prop = n/sum(n)) %>%
mutate(perc= prop*100)
fre_her_perc <- FEH %>%
filter(bilingual_type=="fre-her")%>%
group_by(l1) %>%
tally()%>%
mutate(prop = n/sum(n)) %>%
mutate(perc= prop*100)
her_eng_perc <- FEH %>%
filter(bilingual_type=="eng-her") %>%
group_by(l1) %>%
tally()%>%
mutate(prop = n/sum(n)) %>%
mutate(perc= prop*100)
#l1 amount of exposure range
min_exp_range <- final_data_strat %>%
select(exp_l1) %>%
min()
max_exp_range <-final_data_strat %>%
select(exp_l1) %>%
max()
#Prepping longitudinal data excluding irrelevant cases
longitudinal_data_analyses <- longitudinal_data %>%
arrange(anon_baby_id, age) %>%
group_by(anon_baby_id) %>%
mutate(visit = row_number()) %>%
ungroup() %>%
mutate(first_visit_date = case_when(visit == 1 ~ leq_date)) %>%
mutate(second_visit_date = case_when(visit == 2 ~ leq_date)) %>%
group_by(anon_baby_id) %>%
fill(first_visit_date, second_visit_date, .direction="updown") %>% #to collapse the rows and be able to calculate visit
ungroup() %>%
mutate(length_between_visits = abs(interval(start= first_visit_date, end=second_visit_date)/ duration (n=1, unit="days" ))) %>%
filter(! length_between_visits < 15) %>%
mutate(l1 = case_when(l1=="French" ~ "French",
l1=="English" ~ "English",
TRUE ~ "Heritage")) %>%
mutate(l2 = case_when(l2=="French" ~ "French",
l2=="English" ~ "English",
TRUE ~ "Heritage")) %>%
mutate(bilingual_type = case_when(l1 %in% c("French", "English") & l2 %in% c("French", "English") ~ "fre-eng",
l1 %in% c("French", "Heritage") & l2 %in% c("French", "Heritage") ~ "fre-her",
l1 %in% c("Heritage", "English") & l2 %in% c("Heritage", "English") ~ "eng-her"))
#Longitudinal data set n
n_long <-longitudinal_data_analyses %>%
distinct(unique_id)%>%
tally()
#Longitudinal data set length between visit one and 2
visit_length <- longitudinal_data_analyses %>%
filter(visit <= 2)
avg_visit_l <- round(mean(visit_length$length_between_visits), 2)
min_visit_l <- round(min(visit_length$length_between_visits),2)
max_visit_l <- round(max(visit_length$length_between_visits),2)
sd_visit_l <- round(sd(visit_length$length_between_visits),2)
FEH <- FEH %>%
right_join(SES_info, FEH, by=c("unique_id", "study", "anon_baby_id"))
##MATERNAL EDUCATION French-English sample
FE_maternal_education <- FEH %>%
##MATERNAL EDUCATION French-English sample
FE_maternal_education <- FEH %>%
filter(bilingual_type=="fre_eng") %>%
group_by(maternal_education) %>%
tally()%>%
mutate(prop = n/sum(n)) %>%
mutate(perc= prop*100)
##MATERNAL EDUCATION French-English sample
FE_maternal_education <- FEH %>%
filter(bilingual_type=="fre_eng") %>%
group_by(maternal_education) %>%
tally()%>%
mutate(prop = n/sum(n)) %>%
mutate(perc= prop*100)
View(FE_maternal_education)
View(FEH)
##MATERNAL EDUCATION French-English sample
FE_maternal_education <- FEH %>%
filter(bilingual_type=="fre-eng") %>%
group_by(maternal_education) %>%
tally()%>%
mutate(prop = n/sum(n)) %>%
mutate(perc= prop*100)
View(FE_maternal_education)
##Paternal EDUCATION French-English sample
FE_paternal_education <- FEH %>%
filter(bilingual_type=="fre-eng") %>%
group_by(paternal_education) %>%
tally()%>%
mutate(prop = n/sum(n)) %>%
mutate(perc= prop*100)
View(FE_paternal_education)
##Child ethnicity French-English sample
FE_child_ethicity <- FEH %>%
filter(bilingual_type=="fre-eng") %>%
group_by(child_ethnicity) %>%
tally()%>%
mutate(prop = n/sum(n)) %>%
mutate(perc= prop*100)
View(FE_child_ethicity)
0.4+0.4+0.4+0.9+1.8+4+0.4+0.9+0.4+0.4+0.4+2+0.4+0.4+1.8+0.4+0.4
1.8+4+0.4+0.9+0.4+0.4+0.4+2+0.4+0.4+1.8+0.4
##MATERNAL EDUCATION heritage sample
her_maternal_education <- FEH %>%
filter(!bilingual_type=="fre-eng") %>%
group_by(maternal_education) %>%
tally()%>%
mutate(prop = n/sum(n)) %>%
mutate(perc= prop*100)
View(her_maternal_education)
##Paternal EDUCATION heritage sample
her_paternal_education <- FEH %>%
filter(!bilingual_type=="fre-eng") %>%
group_by(paternal_education) %>%
tally()%>%
mutate(prop = n/sum(n)) %>%
mutate(perc= prop*100)
View(her_paternal_education)
##Child ethnicity her sample
her_child_ethicity <- FEH %>%
filter(!bilingual_type=="fre-eng") %>%
group_by(child_ethnicity) %>%
tally()%>%
mutate(prop = n/sum(n)) %>%
mutate(perc= prop*100)
View(her_child_ethicity)
5+12+7+2+2
12+7+5+2+2
28+20+10+10+8+6+3
85+15
