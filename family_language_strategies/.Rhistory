chisq_p<- xsq_test$p.value
print(chisq_value)
library(here)
library(lme4)
library(lmerTest)
library(rstatix)
library(papeR)
library(knitr)
library(waffle)
library(ggsankey)
library(dplyr)
library(tidyverse)
load(here("anonymized_data/final_merged_data.Rda"))
load(here("anonymized_data/final_data_no_exc.Rda"))
load(here("anonymized_data/final_data_strat.Rda"))
load(here("anonymized_data/longitudinal_data.Rda"))
library(here)
library(lme4)
library(lmerTest)
library(rstatix)
library(papeR)
library(knitr)
library(waffle)
library(ggsankey)
library(dplyr)
library(tidyverse)
load(here("anonymized_data/final_merged_data.Rda"))
load(here("anonymized_data/final_data_no_exc.Rda"))
load(here("anonymized_data/final_data_strat.Rda"))
load(here("anonymized_data/longitudinal_data.Rda"))
#### CONSTRUCTING AND DESCRIBING ALL RELEVANT DATA SETS ####
#Exclusions count
total_excluded<- final_data_no_exc %>%
group_by(unique_id, exp_l1, exp_l2)%>%
mutate(total_l1_l2_exp=(sum(exp_l1,exp_l2,na.rm = T))) %>%
ungroup() %>%
filter(total_l1_l2_exp<=90) %>%
distinct(unique_id)%>%
tally()
#after third language exclusions exclusions
n <- final_data %>%
distinct(unique_id) %>%
tally()
#subseting to get data only from each child's first visit to the lab. For main analyses
first_visit_only <- final_data_strat%>%
arrange(anon_baby_id, age) %>%
group_by(anon_baby_id) %>%
mutate(visit = row_number()) %>%
ungroup() %>%
filter(visit==1) #439 data from first visit only
#n when only taking first visit
n_keep_first_visit<-first_visit_only %>%
distinct(unique_id)%>%
tally()
age_min <- round(min(first_visit_only$age, na.rm = T), 2)
age_max<- round(max(first_visit_only$age, na.rm = T), 2)
age_mean<- round(mean(first_visit_only$age, na.rm = T), 2)
age_sd<- round(sd(first_visit_only$age, na.rm = T), 2)
female<- first_visit_only %>%
filter(gender=="female")%>%
distinct(unique_id)%>%
tally()
twice_visit <- final_data %>%
add_count(anon_baby_id) %>%
filter(nn==2)%>%
distinct(unique_id)%>%
tally()
three_visit <- final_data %>%
add_count(anon_baby_id) %>%
filter(nn==3)%>%
distinct(unique_id)%>%
tally()
four_visit <- final_data %>%
add_count(anon_baby_id) %>%
filter(nn>3)%>%
distinct(unique_id)%>%
tally()
#Longitudinal data set n
n_long <-longitudinal_data %>%
distinct(unique_id)%>%
tally()
#Family language strategy visualization
#Calculating how many families use each strategy and its corresponding %
prop_strategy<- first_visit_only %>%
group_by(strategy) %>%
tally() %>%
mutate(prop = n/sum(n)) %>%
mutate(perc= prop*100)
both_parents_biling<- prop_strategy %>%
filter(strategy=="both-parents-bilingual") %>%
select(perc)
perc_both_parents_biling<- round(both_parents_biling$perc, 1)
prop_strategy<- prop_strategy %>%
mutate(strategy = fct_reorder(prop_strategy$strategy, prop_strategy$prop, .desc=T))
#Waffle plot
figure_1<- ggplot(prop_strategy, aes(fill=strategy, values= n, na.rm=T)) +
geom_waffle (n_rows=22, color="white")+
scale_fill_manual (name = "Family Strategy", values =c("#7570b3","#33a02c","#b2df8a", "#d95f02", "#FFC107", "#1f78b4")) +
labs(x="", title = "Proportion of Use of Family Strategies")+
theme(axis.text.x= element_blank(), axis.ticks = element_blank())+
coord_equal()+
theme_void()
n
twice_visit
four_visit
first_visit_only
chisq_value
chisq_value<- xsq_test$statistic
xsq_test<- chisq.test(prop_strategy$n)
library(here)
library(lme4)
library(lmerTest)
library(rstatix)
library(papeR)
library(knitr)
library(waffle)
library(ggsankey)
library(dplyr)
library(tidyverse)
load(here("anonymized_data/final_merged_data.Rda"))
load(here("anonymized_data/final_data_no_exc.Rda"))
load(here("anonymized_data/final_data_strat.Rda"))
load(here("anonymized_data/longitudinal_data.Rda"))
#### CONSTRUCTING AND DESCRIBING ALL RELEVANT DATA SETS ####
#Exclusions count
total_excluded<- final_data_no_exc %>%
group_by(unique_id, exp_l1, exp_l2)%>%
mutate(total_l1_l2_exp=(sum(exp_l1,exp_l2,na.rm = T))) %>%
ungroup() %>%
filter(total_l1_l2_exp<=90) %>%
distinct(unique_id)%>%
tally()
#after third language exclusions exclusions
n <- final_data %>%
distinct(unique_id) %>%
tally()
#subseting to get data only from each child's first visit to the lab. For main analyses
first_visit_only <- final_data_strat%>%
arrange(anon_baby_id, age) %>%
group_by(anon_baby_id) %>%
mutate(visit = row_number()) %>%
ungroup() %>%
filter(visit==1) #439 data from first visit only
#n when only taking first visit
n_keep_first_visit<-first_visit_only %>%
distinct(unique_id)%>%
tally()
age_min <- round(min(first_visit_only$age, na.rm = T), 2)
age_max<- round(max(first_visit_only$age, na.rm = T), 2)
age_mean<- round(mean(first_visit_only$age, na.rm = T), 2)
age_sd<- round(sd(first_visit_only$age, na.rm = T), 2)
female<- first_visit_only %>%
filter(gender=="female")%>%
distinct(unique_id)%>%
tally()
twice_visit <- final_data %>%
add_count(anon_baby_id) %>%
filter(nn==2)%>%
distinct(unique_id)%>%
tally()
three_visit <- final_data %>%
add_count(anon_baby_id) %>%
filter(nn==3)%>%
distinct(unique_id)%>%
tally()
four_visit <- final_data %>%
add_count(anon_baby_id) %>%
filter(nn>3)%>%
distinct(unique_id)%>%
tally()
#Longitudinal data set n
n_long <-longitudinal_data %>%
distinct(unique_id)%>%
tally()
#Family language strategy visualization
#Calculating how many families use each strategy and its corresponding %
prop_strategy<- first_visit_only %>%
group_by(strategy) %>%
tally() %>%
mutate(prop = n/sum(n)) %>%
mutate(perc= prop*100)
both_parents_biling<- prop_strategy %>%
filter(strategy=="both-parents-bilingual") %>%
select(perc)
perc_both_parents_biling<- round(both_parents_biling$perc, 1)
prop_strategy<- prop_strategy %>%
mutate(strategy = fct_reorder(prop_strategy$strategy, prop_strategy$prop, .desc=T))
#Waffle plot
figure_1<- ggplot(prop_strategy, aes(fill=strategy, values= n, na.rm=T)) +
geom_waffle (n_rows=22, color="white")+
scale_fill_manual (name = "Family Strategy", values =c("#7570b3","#33a02c","#b2df8a", "#d95f02", "#FFC107", "#1f78b4")) +
labs(x="", title = "Proportion of Use of Family Strategies")+
theme(axis.text.x= element_blank(), axis.ticks = element_blank())+
coord_equal()+
theme_void()
for_chisq <- prop_strategy %>%
filter(strategy=="single-parent") # filter single parents because the cell size is small
xsq_test<- chisq.test(prop_strategy$n)
chisq_value<- round(xsq_test$statistic, 2)
chisq_p<- xsq_test$p.value
chisq_value
chisq_p<- round(xsq_test$p.value, 4)
chisq_p
View(prop_strategy)
prop_strategy<- prop_strategy %>%
mutate(strategy = fct_reorder(strateg$prop, .desc=F))
prop_strategy<- prop_strategy %>%
mutate(strategy = fct_reorder(strategy$prop, .desc=F))
?fct_reorder
prop_strategy<- prop_strategy %>%
mutate(strategy = fct_reorder(strategy, prop))
View(prop_strategy)
library(here)
library(lme4)
library(lmerTest)
library(rstatix)
library(papeR)
library(knitr)
library(waffle)
library(ggsankey)
library(dplyr)
library(tidyverse)
load(here("anonymized_data/final_merged_data.Rda"))
load(here("anonymized_data/final_data_no_exc.Rda"))
load(here("anonymized_data/final_data_strat.Rda"))
load(here("anonymized_data/longitudinal_data.Rda"))
#### CONSTRUCTING AND DESCRIBING ALL RELEVANT DATA SETS ####
#Exclusions count
total_excluded<- final_data_no_exc %>%
group_by(unique_id, exp_l1, exp_l2)%>%
mutate(total_l1_l2_exp=(sum(exp_l1,exp_l2,na.rm = T))) %>%
ungroup() %>%
filter(total_l1_l2_exp<=90) %>%
distinct(unique_id)%>%
tally()
#after third language exclusions exclusions
n <- final_data %>%
distinct(unique_id) %>%
tally()
#subseting to get data only from each child's first visit to the lab. For main analyses
first_visit_only <- final_data_strat%>%
arrange(anon_baby_id, age) %>%
group_by(anon_baby_id) %>%
mutate(visit = row_number()) %>%
ungroup() %>%
filter(visit==1) #439 data from first visit only
#n when only taking first visit
n_keep_first_visit<-first_visit_only %>%
distinct(unique_id)%>%
tally()
age_min <- round(min(first_visit_only$age, na.rm = T), 2)
age_max<- round(max(first_visit_only$age, na.rm = T), 2)
age_mean<- round(mean(first_visit_only$age, na.rm = T), 2)
age_sd<- round(sd(first_visit_only$age, na.rm = T), 2)
female<- first_visit_only %>%
filter(gender=="female")%>%
distinct(unique_id)%>%
tally()
twice_visit <- final_data %>%
add_count(anon_baby_id) %>%
filter(nn==2)%>%
distinct(unique_id)%>%
tally()
three_visit <- final_data %>%
add_count(anon_baby_id) %>%
filter(nn==3)%>%
distinct(unique_id)%>%
tally()
four_visit <- final_data %>%
add_count(anon_baby_id) %>%
filter(nn>3)%>%
distinct(unique_id)%>%
tally()
#Longitudinal data set n
n_long <-longitudinal_data %>%
distinct(unique_id)%>%
tally()
#Family language strategy visualization
#Calculating how many families use each strategy and its corresponding %
prop_strategy<- first_visit_only %>%
group_by(strategy) %>%
tally() %>%
mutate(prop = n/sum(n)) %>%
mutate(perc= prop*100)
both_parents_biling<- prop_strategy %>%
filter(strategy=="both-parents-bilingual") %>%
select(perc)
perc_both_parents_biling<- round(both_parents_biling$perc, 1)
#prop_strategy<- prop_strategy %>%
# mutate(strategy = fct_reorder(strategy, prop))
#Waffle plot
figure_1<- ggplot(prop_strategy, aes(fill=fct_reorder(strategy, prop), values= n, na.rm=T)) +
geom_waffle (n_rows=22, color="white")+
scale_fill_manual (name = "Family Strategy", values =c("#7570b3","#33a02c","#b2df8a", "#d95f02", "#FFC107", "#1f78b4")) +
labs(x="", title = "Proportion of Use of Family Strategies")+
theme(axis.text.x= element_blank(), axis.ticks = element_blank())+
coord_equal()+
theme_void()
figure_1<- ggplot(prop_strategy, aes(fill=fct_reorder(strategy, n), values= n, na.rm=T)) +
geom_waffle (n_rows=22, color="white")+
scale_fill_manual (name = "Family Strategy", values =c("#7570b3","#33a02c","#b2df8a", "#d95f02", "#FFC107", "#1f78b4")) +
labs(x="", title = "Proportion of Use of Family Strategies")+
theme(axis.text.x= element_blank(), axis.ticks = element_blank())+
coord_equal()+
theme_void()
print(figure_1)
library(here)
library(lme4)
library(lmerTest)
library(rstatix)
library(papeR)
library(knitr)
library(waffle)
library(ggsankey)
library(dplyr)
library(tidyverse)
load(here("anonymized_data/final_merged_data.Rda"))
load(here("anonymized_data/final_data_no_exc.Rda"))
load(here("anonymized_data/final_data_strat.Rda"))
load(here("anonymized_data/longitudinal_data.Rda"))
#### CONSTRUCTING AND DESCRIBING ALL RELEVANT DATA SETS ####
#Exclusions count
total_excluded<- final_data_no_exc %>%
group_by(unique_id, exp_l1, exp_l2)%>%
mutate(total_l1_l2_exp=(sum(exp_l1,exp_l2,na.rm = T))) %>%
ungroup() %>%
filter(total_l1_l2_exp<=90) %>%
distinct(unique_id)%>%
tally()
#after third language exclusions exclusions
n <- final_data %>%
distinct(unique_id) %>%
tally()
#subseting to get data only from each child's first visit to the lab. For main analyses
first_visit_only <- final_data_strat%>%
arrange(anon_baby_id, age) %>%
group_by(anon_baby_id) %>%
mutate(visit = row_number()) %>%
ungroup() %>%
filter(visit==1) #439 data from first visit only
#n when only taking first visit
n_keep_first_visit<-first_visit_only %>%
distinct(unique_id)%>%
tally()
age_min <- round(min(first_visit_only$age, na.rm = T), 2)
age_max<- round(max(first_visit_only$age, na.rm = T), 2)
age_mean<- round(mean(first_visit_only$age, na.rm = T), 2)
age_sd<- round(sd(first_visit_only$age, na.rm = T), 2)
female<- first_visit_only %>%
filter(gender=="female")%>%
distinct(unique_id)%>%
tally()
twice_visit <- final_data %>%
add_count(anon_baby_id) %>%
filter(nn==2)%>%
distinct(unique_id)%>%
tally()
three_visit <- final_data %>%
add_count(anon_baby_id) %>%
filter(nn==3)%>%
distinct(unique_id)%>%
tally()
four_visit <- final_data %>%
add_count(anon_baby_id) %>%
filter(nn>3)%>%
distinct(unique_id)%>%
tally()
#Longitudinal data set n
n_long <-longitudinal_data %>%
distinct(unique_id)%>%
tally()
#Family language strategy visualization
#Calculating how many families use each strategy and its corresponding %
prop_strategy<- first_visit_only %>%
group_by(strategy) %>%
tally() %>%
mutate(prop = n/sum(n)) %>%
mutate(perc= prop*100)
both_parents_biling<- prop_strategy %>%
filter(strategy=="both-parents-bilingual") %>%
select(perc)
perc_both_parents_biling<- round(both_parents_biling$perc, 1)
prop_strategy<- prop_strategy %>%
arrange(prop)
#Waffle plot
figure_1<- ggplot(prop_strategy, aes(fill=strategy, values= n, na.rm=T)) +
geom_waffle (n_rows=22, color="white")+
scale_fill_manual (name = "Family Strategy", values =c("#7570b3","#33a02c","#b2df8a", "#d95f02", "#FFC107", "#1f78b4")) +
labs(x="", title = "Proportion of Use of Family Strategies")+
theme(axis.text.x= element_blank(), axis.ticks = element_blank())+
coord_equal()+
theme_void()
print(figure_1)
library(here)
library(lme4)
library(lmerTest)
library(rstatix)
library(papeR)
library(knitr)
library(waffle)
library(ggsankey)
library(dplyr)
library(tidyverse)
load(here("anonymized_data/final_merged_data.Rda"))
load(here("anonymized_data/final_data_no_exc.Rda"))
load(here("anonymized_data/final_data_strat.Rda"))
load(here("anonymized_data/longitudinal_data.Rda"))
#### CONSTRUCTING AND DESCRIBING ALL RELEVANT DATA SETS ####
#Exclusions count
total_excluded<- final_data_no_exc %>%
group_by(unique_id, exp_l1, exp_l2)%>%
mutate(total_l1_l2_exp=(sum(exp_l1,exp_l2,na.rm = T))) %>%
ungroup() %>%
filter(total_l1_l2_exp<=90) %>%
distinct(unique_id)%>%
tally()
#after third language exclusions exclusions
n <- final_data %>%
distinct(unique_id) %>%
tally()
#subseting to get data only from each child's first visit to the lab. For main analyses
first_visit_only <- final_data_strat%>%
arrange(anon_baby_id, age) %>%
group_by(anon_baby_id) %>%
mutate(visit = row_number()) %>%
ungroup() %>%
filter(visit==1) #439 data from first visit only
#n when only taking first visit
n_keep_first_visit<-first_visit_only %>%
distinct(unique_id)%>%
tally()
age_min <- round(min(first_visit_only$age, na.rm = T), 2)
age_max<- round(max(first_visit_only$age, na.rm = T), 2)
age_mean<- round(mean(first_visit_only$age, na.rm = T), 2)
age_sd<- round(sd(first_visit_only$age, na.rm = T), 2)
female<- first_visit_only %>%
filter(gender=="female")%>%
distinct(unique_id)%>%
tally()
twice_visit <- final_data %>%
add_count(anon_baby_id) %>%
filter(nn==2)%>%
distinct(unique_id)%>%
tally()
three_visit <- final_data %>%
add_count(anon_baby_id) %>%
filter(nn==3)%>%
distinct(unique_id)%>%
tally()
four_visit <- final_data %>%
add_count(anon_baby_id) %>%
filter(nn>3)%>%
distinct(unique_id)%>%
tally()
#Longitudinal data set n
n_long <-longitudinal_data %>%
distinct(unique_id)%>%
tally()
#Family language strategy visualization
#Calculating how many families use each strategy and its corresponding %
prop_strategy<- first_visit_only %>%
group_by(strategy) %>%
tally() %>%
mutate(prop = n/sum(n)) %>%
mutate(perc= prop*100)
both_parents_biling<- prop_strategy %>%
filter(strategy=="both-parents-bilingual") %>%
select(perc)
perc_both_parents_biling<- round(both_parents_biling$perc, 1)
prop_strategy<- prop_strategy %>%
arrange(desc(prop))
#Waffle plot
figure_1<- ggplot(prop_strategy, aes(fill=strategy, values= n, na.rm=T)) +
geom_waffle (n_rows=22, color="white")+
scale_fill_manual (name = "Family Strategy", values =c("#7570b3","#33a02c","#b2df8a", "#d95f02", "#FFC107", "#1f78b4")) +
labs(x="", title = "Proportion of Use of Family Strategies")+
theme(axis.text.x= element_blank(), axis.ticks = element_blank())+
coord_equal()+
theme_void()
print(figure_1)
figure_1<- ggplot(prop_strategy, aes(fill=strategy, values= n, na.rm=T)) +
geom_waffle (n_rows=22, color="white")+
scale_fill_manual (name = "Family Strategy", values =c("#1f78b4", "#FFC107", "#d95f02",  "#7570b3", "#b2df8a", "#33a02c" )) +
labs(x="", title = "Proportion of Use of Family Strategies")+
theme(axis.text.x= element_blank(), axis.ticks = element_blank())+
coord_equal()+
theme_void()
print(figure_1)
figure_1<- ggplot(prop_strategy, aes(fill=strategy, values= n, na.rm=T)) +
geom_waffle (n_rows=22, color="white")+
scale_fill_manual (name = "Family Strategy", values =c("#FFC107", "#d95f02", "#1f78b4",  "#7570b3", "#b2df8a", "#33a02c" )) +
labs(x="", title = "Proportion of Use of Family Strategies")+
theme(axis.text.x= element_blank(), axis.ticks = element_blank())+
coord_equal()+
theme_void()
print(figure_1)
figure_1<- ggplot(prop_strategy, aes(fill=strategy, values= n, na.rm=T)) +
geom_waffle (n_rows=22, color="white")+
scale_fill_manual (name = "Family Strategy", values =c("#FFC107", "#1f78b4", "#d95f02", "#7570b3", "#b2df8a", "#33a02c" )) +
labs(x="", title = "Proportion of Use of Family Strategies")+
theme(axis.text.x= element_blank(), axis.ticks = element_blank())+
coord_equal()+
theme_void()
print(figure_1)
figure_1<- ggplot(prop_strategy, aes(fill=strategy, values= n, na.rm=T)) +
geom_waffle (n_rows=22, color="white")+
scale_fill_manual (name = "Family Strategy", values =c("#FFC107", "#1f78b4", "#d95f02", "#b2df8a", "#33a02c", "#7570b3" )) +
labs(x="", title = "Proportion of Use of Family Strategies")+
theme(axis.text.x= element_blank(), axis.ticks = element_blank())+
coord_equal()+
theme_void()
print(figure_1)
