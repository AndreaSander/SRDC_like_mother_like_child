---
title: "results_markdown"
author: "ASM"
date: "13/01/2023 last updated 07/02/2023"
output: word_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
options(scipen = 100, digits = 4)
```

```{r data call in, include=FALSE}
library(lubridate)
library(sparkline)
library(webshot)
library(htmlwidgets)
library(formattable)
library(here)
library(lme4)
library(lmerTest)
library(rstatix)
library(papeR)
library(knitr)
library(waffle)
library(ggsankey)
library(dplyr)
library(tidyverse)
load(here("anonymized_data/final_merged_data.Rda"))
load(here("anonymized_data/final_data_no_exc.Rda"))
load(here("anonymized_data/final_data_strat.Rda"))
load(here("anonymized_data/longitudinal_data.Rda"))

#Saving my palette to use in visualizations
my_yellow<-"#FFC107"
my_orange<- "#D95F02"
my_blue<- "#1F78B4"
my_green<- "#33a02c"
my_purple<- "#7570b3"

```

## Methods

### Participants
```{r participants information, include=FALSE}
#### CONSTRUCTING AND DESCRIBING ALL RELEVANT DATA SETS ####

#Trilingul exclusions count
total_excluded_triling<- final_data_no_exc %>%
    group_by(unique_id, exp_l1, exp_l2)%>%
   mutate(total_l1_l2_exp=(sum(exp_l1,exp_l2,na.rm = T))) %>%
  ungroup() %>%
  filter(total_l1_l2_exp<=90) %>%
  distinct(unique_id)%>%
  tally()

#Monolingual strategies count
monoling_strategies_Count <-
  final_data_no_exc %>% 
  mutate(monoling_strategy = case_when(
    care1_l1=="regularly" & care1_l2 %in% c("never", "NA") & care2_l1=="regularly" &care2_l2 %in% c("never", "NA")~ "yes",
    care1_l1 %in% c("never", "NA") & care1_l2=="regularly" & care2_l1 %in% c("never", "NA") & care2_l2=="regularly"~ "yes",
    TRUE~"No"))%>%
  mutate(bilinugal_strategy= case_when(monoling_strategy=="yes" & childcare_l1 == l1 & childcare_l2 %in% c(NA, "NA")  ~ "no",
                                       monoling_strategy=="yes"& childcare_l2 == l1 & childcare_l1 %in% c(NA, "NA") ~"no",
                                       monoling_strategy=="yes" & childcare_l1 %in% c(NA, "NA") & childcare_l2 %in% c(NA, "NA") ~"no",
                                       TRUE~"yes")) %>%
  filter(bilinugal_strategy=="no") %>%
  distinct(unique_id)%>%
  tally()


#after third language exclusions exclusions
n <- final_data %>%
  distinct(unique_id) %>%
  tally()

#subseting to get data only from each child's first visit to the lab. For main analyses
first_visit_only <- final_data_strat%>%
    arrange(anon_baby_id, age) %>%
  group_by(anon_baby_id) %>%
  mutate(visit = row_number()) %>%
  ungroup() %>%
  filter(visit==1) #439 data from first visit only

#n when only taking first visit
n_keep_first_visit<-first_visit_only %>%
  distinct(unique_id)%>%
  tally()

age_min <- round(min(first_visit_only$age, na.rm = T), 2)
age_max<- round(max(first_visit_only$age, na.rm = T), 2)
age_mean<- round(mean(first_visit_only$age, na.rm = T), 2)
age_sd<- round(sd(first_visit_only$age, na.rm = T), 2)

female<- first_visit_only %>%
  filter(gender=="female")%>%
  distinct(unique_id)%>%
  tally()

twice_visit <- final_data %>%
  add_count(anon_baby_id) %>%
  filter(nn==2)%>%
  distinct(unique_id)%>%
  tally()

three_visit <- final_data %>%
  add_count(anon_baby_id) %>%
  filter(nn==3)%>%
  distinct(unique_id)%>%
  tally()

four_visit <- final_data %>%
  add_count(anon_baby_id) %>%
  filter(nn>3)%>%
  distinct(unique_id)%>%
  tally()

#l1 percentages
l1_perc <- first_visit_only %>%
group_by(l1) %>%
  tally() %>%
  mutate(prop = n/sum(n)) %>%
  mutate(perc= prop*100)

fre_l1 <- l1_perc %>%
  filter(l1=="French") %>%
  select(perc)

eng_l1 <- l1_perc %>%
  filter(l1=="English") %>%
  select(perc)
  
min_l1<- abs(fre_l1-eng_l1)


#l2 percentages
l2_perc <- first_visit_only %>%
group_by(l2) %>%
  tally() %>%
  mutate(prop = n/sum(n)) %>%
  mutate(perc= prop*100)

fre_l2 <- l2_perc %>%
  filter(l2=="French") %>%
  select(perc)

eng_l2 <- l2_perc %>%
  filter(l2=="English") %>%
  select(perc)
  
min_l2<- abs(fre_l2-eng_l2)

#l1 amount of exposure range
min_exp_range <- final_data %>%
  select(exp_l1) %>%
  min()

max_exp_range <-final_data %>%
  select(exp_l1) %>%
  max()

#Prepping longitudinal data excluding irrelevant cases

longitudinal_data_analyses <- longitudinal_data %>%
  select(age, strategy, unique_id, anon_baby_id, leq_date)

longitudinal_data_analyses <- longitudinal_data %>%
  arrange(anon_baby_id, age) %>%
  group_by(anon_baby_id) %>%
  mutate(visit = row_number()) %>%
  ungroup() %>% 
  mutate(first_visit_date = case_when(visit == 1 ~ leq_date)) %>%
  mutate(second_visit_date = case_when(visit == 2 ~ leq_date)) %>%
  group_by(anon_baby_id) %>%
  fill(first_visit_date, second_visit_date, .direction="updown") %>% #to collapse the rows and be able to calculate visit
  ungroup() %>%
  mutate(length_between_visits = abs(interval(start= first_visit_date, end=second_visit_date)/ duration (n=1, unit="days" ))) %>%
  filter(! length_between_visits < 15) 

#Longitudinal data set n
n_long <-longitudinal_data_analyses %>%
  distinct(unique_id)%>%
  tally()

#Longitudinal data set length between visit one and 2
visit_length<- longitudinal_data %>%
  arrange(anon_baby_id, age) %>%
  group_by(anon_baby_id) %>%
  mutate(visit = row_number()) %>%
  ungroup() %>%
  filter(nn==2) %>%
  mutate(first_visit_date = case_when(visit == 1 ~ leq_date)) %>%
  mutate(second_visit_date = case_when(visit == 2 ~ leq_date)) %>%
  select(anon_baby_id, first_visit_date, second_visit_date) %>%
  group_by(anon_baby_id) %>%
  fill(first_visit_date, second_visit_date, .direction="updown") %>% #to collapse the rows and be able to calculate visit
  distinct() %>%
  ungroup() %>%
  mutate(length_between_visits = abs(interval(start= first_visit_date, end=second_visit_date)/ duration (n=1, unit="days" ))) %>%
  filter(! length_between_visits < 15) ##Filter visits that were very close together. 
##!! There is a mistake in one date which results in a negative date. Fix.


avg_visit_l <- round(mean(visit_length$length_between_visits), 2)
min_visit_l <- round(min(visit_length$length_between_visits),2)
max_visit_l <- round(max(visit_length$length_between_visits),2)
sd_visit_l <- round(sd(visit_length$length_between_visits),2)
```

  Families were contacted from a database of interested families in MontrÃ©al, Canada, largely via provincial birth lists, social media, and in-person recruitment, for example at libraries and community events. Data were collected through convenience sampling when they visited Concordia Infant Research Laboratory to participate in various studies examining bilingual language acquisition. 
  
  Our dataset consists of demographic and language exposure information collected between the years 2013 and 2020 via parental questionnaires and forms (described below). Caregivers filled out the questionnaires during each visit as part of the lab standard practice. At each visit, the infants also participated in one or more experimental tasks, and parents completed additional questionnaires, but these are not the focus of this research. All parents signed a consent form, and they were given a small thank-you gift for their participation. The current study was approved by Concordia University Human Research Ethics Board (Certification Number 10000439). 
 
 The original sample consisted of data from `r n` participants. This sample included repeated measures from some families who visited the lab twice (`r twice_visit`), three times (`r three_visit`), and four or more times (`r four_visit`). However, for our main analyses we decided to only keep one observation per family, thus we kept families who contributed data once as well as the data from the first visit of families who contributed data during multiple visits. We decided to keep data from the first visit only because that made the data from families with multiple visits and families with a single visit easier to compare. 
 
 Most infants in our data were exposed to two languages. We defined the first language (L1) as the language to which they were most exposed which ranged from `r min_exp_range`  to `r max_exp_range` in our sample, as some infants were exposed to a small amount of a third language. We therefore defined the second language (L2) as the language to which they were second most exposed. We excluded `r total_excluded_triling` children who heard more than 10% of a third language from our original sample. Our sample was composed of infants who heard `r fre_l1`% of French, `r eng_l1`% of English, and `r min_l1`% of a heritage language as L1; and `r fre_l2`% of which heard French, `r eng_l2`% of English and `r min_l2`% of a Heritage language as L2. A heritage language was defined as any language other than French or English. There were two reasons behind this decision. First, in Montreal, Canada, both French and English hold a majority language status, making other languages heritage or minority languages. Second, infants who heard a language other than English and French heard one of a wide variety of the following languages: Kabyle, Russian, Romanian, German, Japanese, Arabic, Tamil, Mandarin, Spanish, Italian,   Cantonese, Tagalog, Portuguese, Persian, Greek, Creole, Polish, Edo, Armenian, Hindi, Khasi, Berber, Korean, Lithuanian, Wolof, or Yoruba. Since it would have been impractical to divide the sample in so many language groups, and since those groups had few participants, we decided to collapse them into a single heritage language group.
 
 Because the purpose of the present study is to explore bilingual family language strategies we excluded, to the best of our abilities, families who were not using bilingual strategies (n= `r monoling_strategies_count`. We characterized these families as those where both caregivers reported using a single language with the child, and that reported either that the child attended a daycare where they only used the same language, the child had no other form of childcare, or there was missing data regarding other forms of childcare. That being said, we retained data from families that reported using two different languages with the child, but whse child ended up having a reported input of 100% to a single language. We retained those monolingual input/ bilingual strategy families for our descripted analyses, but we removed this data from our statistical analyses as it will be detailed below in the data pre-reocessing section of this manuscript.
 
 After exclusions, the final dataset consisted of `r n_keep_first_visit` participants  aged `r age_min` to `r age_max` months (M=`r age_mean`, SD=`r age_sd`). Of whom `r female` were female. While for the main analyses we excluded the second visit data of families' who contributed data during multiple visits, we constructed a secondary longitudinal data set (n= `r n_long`) which included first and second visit data from these families. We used the longitudinal data for some descriptive analyses (described below). We however excluded the third and fourth visit data from both the main and the exploratory analyses because there were very few data points. We also excluded a second visit that occurred in less than 15 days from the first visit. The length between visits one and two varied between `r min_visit_l` and `r max_visit_l` days (m= `r avg_visit_l`days, sd= `r sd_visit_l` days).
 


### Instrument
  Information concerning the language environment of the infant was gathered through the Language Exposure Questionnaire (LEQ; Bosch & SebastiÃ¡n-GallÃ©s, 2001; See appendix A) following the Multilingual Approach to Language Estimates (MAPLE; Byers-Heinlein et al, 2019), in which interviewers walk caregivers through a series of questions designed to help them accurately remember and realize the language environment and exposure of their infant. 
  
  The first set of questions for the LEQ with MAPLE interview aim to understand how caregivers use their languages in daily life, particularly when talking to their infant. These questions use a likert type of scale to describe the frequency with which parents use each language when talking to their child (regularly, sometimes, or never). We used the responses from the first section of the LEQ questionnaire to characterize the family language strategy used by each family. As a reminder, parents answer the frequency with which they used each language, so the responses âregularlyâ, âsometimesâ, âneverâ were given for each language. For example, for a family where both parents indicated they used both their first and second language regularly we assigned the both parents bilingual strategy. By contrast, for a family where each parent spoke a different first language regularly we assigned the one-parent-one-language strategy.  In this manner we identified four distinct strategies: both parents bilingual, one parent bilingual, one-parent-one-language, and one language at home (see Table 1). In these subcategories parents that spoke their first language regularly and never spoke another language would be categorized as strict, and parents who each spoke their first language regularly but one of them sometimes would speak another language were categorized as flexible. As we discuss further below, these two categories were ultimately collapsed into a single one-parent-one-language category. Finally, we identified a few families with a single caregiver and we characterized them as single parent families, as we didnât have enough cases to identify distinct strategies which single parents might use.
  
  The second set of questions for the LEQ with MAPLE interview aim to give a set of estimates of the amount of time babies spend hearing each of their languages throughout their lives based on a detailed calculation made by the interviewer from caregiver responses (cumulative exposure estimate), a rough estimate made by the caregivers themselves (global exposure estimate), and an overall estimate that averages the interviewer and the caregiver estimations (overall exposure estimate). We only used data from the overall exposure estimate to determine how much exposure to each language infants in our sample were getting.
  
  The overall exposure estimate made with LEQ with MAPLE have high reliability (r = .77â.97) when compared to transcriptions of daylong home recordings, which are a direct measure of the infantsâ linguistic environment (Orena et al., 2018).
  
  We additionally collected demographic information about our participants and their families via a short paper form.


## Results 

```{r table describing the family strategies categorization, include=FALSE}

collapse_rows_df <- function(df, variable){
 group_var <- enquo(variable)
  df %>%
    group_by(!! group_var) %>%
    mutate(groupRow = 1:n()) %>%
    ungroup() %>%
    mutate(!!quo_name(group_var) := ifelse(groupRow == 1, as.character(!! group_var), "")) %>%
    select(-c(groupRow))
}

strats_table<- final_data_strat %>%
  select(c(strategy, care1_l1, care1_l2, care2_l1, care2_l2))%>%
  rename(caregiver_A_L1 = care1_l1)%>%
  rename(caregiver_A_L2 = care1_l2)%>%
  rename(caregiver_B_L1 = care2_l1)%>%
  rename(caregiver_B_L2 = care2_l2)%>%
  arrange(strategy) %>%
  distinct() %>%
  collapse_rows_df(strategy)


color_formatter <- formatter(
  "span",
  style = x ~ style(
    color = 'black',
    'background-color' =
      ifelse(x == "regularly", "#a1d76a", ifelse( x=="sometimes","#ffffbf", if_else(x=="never", "#e9a3c9", "white")))
            ))

 formattable(strats_table,
            list(
              `caregiver_A_L1`= color_formatter,
              `caregiver_A_L2`= color_formatter,
              `caregiver_B_L1`= color_formatter,
              `caregiver_B_L2`= color_formatter
            )) %>%
    as.datatable(options = list(pageLength = 35)) %>%
  spk_add_deps() -> w

htmlwidgets::saveWidget(w, "table.html", selfcontained = TRUE)
webshot::webshot(url = "table.html", file = "table.png", 
               vwidth = 1200, vheight = 275)
            
```


### Data Pre-Processing

  All the relevant LEQ data were manually entered from LEQ forms into excel spreadsheets. The data were entered twice by two different researchers to to catch errors, and discrepancies were resolved by a third individual who checked the original paper form. Demographic data were exported from Filemaker. 
  
  In preliminary analyses, we noticed that the one-parent-one-language strict and flexible categories both categories behaved similarly as predictors when performing statistical tests and other exploratory analyses. Moreover, splitting the categories split the sample size for the one-parent-one-language group, thus decreasing statistical power. Thus we ultimately decided to combine them into a single group. 
  
  Table 1


```{r proportion of strategy use visualizations, include=FALSE}
#Family language strategy visualization


#Calculating how many families use each strategy and its corresponding %
prop_strategy<- first_visit_only %>%
group_by(strategy) %>%
  tally() %>%
  mutate(prop = n/sum(n)) %>%
  mutate(perc= prop*100)

both_parents_biling<- prop_strategy %>%
  filter(strategy=="both-parents-bilingual") %>%
  select(perc)

perc_both_parents_biling<- round(both_parents_biling$perc, 1)

prop_strategy<- prop_strategy %>%
 arrange(desc(prop))

#Waffle plot

figure_1<- ggplot(prop_strategy, aes(fill=strategy, values= n, na.rm=T)) +
  geom_waffle (n_rows=22, color="white")+
  scale_fill_manual (name = "Family Strategy", values =c(my_yellow, my_orange, my_blue, my_green, my_purple)) +
 labs(x="", title = "Proportion of Use of Family Strategies")+
theme(axis.text.x= element_blank(), axis.ticks = element_blank())+
 coord_equal()+
theme_void() 


```
### Analytic approach
  Once characterized, we described the proportions in which family language strategies were used in our sample (See Figure 1). The most common strategy was the both parents bilingual strategy which was used by `r perc_both_parents_biling`% of the sample, and the least common strategy was the one-parent-one-language strategy (XX%).  One-language-at-home and (zz%) one-parent-bilingual (bb%) were intermediate.

Figure 1

```{r, echo=FALSE}
print(figure_1)
```

```{r goodness of fit, include=FALSE}
for_chisq <- prop_strategy %>%
  filter(strategy=="single-parent") # filter single parents because the cell size is small

xsq_test<- chisq.test(prop_strategy$n)

chisq_value<- round(xsq_test$statistic, 2)
chisq_p<- round(xsq_test$p.value, 4)
```

  We performed a chi-square goodness of fit test to determine whether the difference in proportion of usage between strategies was statistically significant, where the null hypothesis was that the strategies were used in the same proportion across the sample. The chi-squared goodness of fit test revealed a statistically significant difference between the distribution of proportions in our data and a distribution in which all the proportions are equal (X= `r chisq_value`, p= <.001).
```{r, include=FALSE}

fre_by_strategy <- first_visit_only  %>%
  select(c(strategy, fre_exp)) %>%
  group_by(strategy) %>%
  dplyr::summarize(mean(fre_exp,  na.rm=TRUE)) %>%
  arrange(desc("mean(fre_exp, na.rm=TRUE)")) 

fre_by_strategy<- rename(fre_by_strategy, "mean_fre_exp" = "mean(fre_exp, na.rm = TRUE)")

figure_2_a <-ggplot(fre_by_strategy, aes( x=strategy , y=mean_fre_exp, fill = strategy )) +
  geom_col() +
   scale_fill_manual (name = "Family Strategy", values =c(my_yellow, my_orange, my_blue, my_green, my_purple)) +
  theme_bw() +
    theme(axis.text.x = element_blank())+
  labs(title= "Mean french exposure by strategy")

eng_by_strategy <- first_visit_only  %>%
  select(c(strategy, eng_exp)) %>%
  group_by(strategy) %>%
  dplyr::summarize(mean(eng_exp, na.rm=TRUE))%>%
  arrange(desc("mean(eng_exp, na.rm=TRUE)"))

eng_by_strategy <- rename(eng_by_strategy, "mean_eng_exp" = "mean(eng_exp, na.rm = TRUE)")

figure_2_b <-ggplot(eng_by_strategy, aes( x=strategy , y= mean_eng_exp, fill = strategy )) +
  geom_col() +
   scale_fill_manual (name = "Family Strategy", values =c(my_yellow, my_orange, my_blue, my_green, my_purple)) +
  theme_bw() +
    theme(axis.text.x = element_blank())+
  labs(title= "Mean english exposure by strategy")

min_by_strategy <- first_visit_only  %>%
  select(c(strategy, min_exp)) %>%
  group_by(strategy) %>%
  dplyr::summarize(mean(min_exp, na.rm=TRUE)) %>%
  arrange(desc("mean(min_exp, na.rm = TRUE)"))

min_by_strategy <- rename(min_by_strategy, "mean_heritage_exp" = "mean(min_exp, na.rm = TRUE)")

figure_2_c <-ggplot(min_by_strategy, aes( x=strategy , y= mean_heritage_exp, fill = strategy )) +
  geom_col() +
   scale_fill_manual (name = "Family Strategy", values =c(my_yellow, my_orange, my_blue, my_green, my_purple)) +
  theme_bw() +
  theme(axis.text.x = element_blank())+
  labs(title= "Mean minority langauge exposure by strategy")


```



```{r performing ANOVAs and Hukey post hoc test, include=FALSE}

for_anovas<- first_visit_only %>%
  filter(!strategy == "single-parent") %>%
  mutate(strategy = case_when(strategy=="both-parents-bilingual"~"BothParentsBilingual",
                              strategy=="one-language-at-home"~"OneLanguageAtHome",
                              strategy=="one-parent-bilingual"~"OneParentBilingual",
                              strategy=="one-parent-one-lang"~"OneParentOneLang"))
##French Anova objects
#Cutting the tails of the distribution to avoid 0 inflation, while we will describe the families that were monolingual, it makes our tests more statistically sound to cut the tails.
for_anovas_f<- for_anovas %>%
  filter(!fre_exp == 0) %>%
  filter(!fre_exp == 100)

anova_model_french <- aov(fre_exp ~ strategy, data= for_anovas_f)
aov_fre<- tidy(anova_model_french)
tukey_fre_s<- TukeyHSD (anova_model_french)
tukey_fre<- tidy(tukey_fre_s)
fre_F <- aov_fre$statistic
fre_p <- aov_fre$p.value

library(performance)
model_performance(anova_model_french)
check_model(anova_model_french)

##English ANOVA objects
for_anovas_e<- for_anovas %>%
  filter(!eng_exp == 0) %>%
  filter(!eng_exp == 100)

anova_model_english <- aov(eng_exp ~ strategy, data= for_anovas_e)
aov_eng<- tidy(anova_model_english)
tukey_eng_s<- TukeyHSD(anova_model_english)
tukey_eng<- tidy(tukey_eng_s)

eng_F <- aov_eng$statistic
eng_p <- aov_eng$p.value

model_performance(anova_model_english)
check_model(anova_model_english)

##Heritage langauge ANOVA Objects
for_anovas_h<- for_anovas %>%
  filter(!min_exp == 0) %>%
  filter(!min_exp == 100)

anova_model_heritage <- aov(min_exp ~ strategy, data= for_anovas_h)
aov_min<- tidy(anova_model_heritage)
tukey_min_s<-TukeyHSD(anova_model_heritage)
tukey_min <- tidy(tukey_min_s)
min_F <- aov_min$statistic
min_p <- aov_min$p.value

model_performance(anova_model_heritage)
check_model(anova_model_heritage)

```

We were also interested to learn how different family language strategies related to the overall amount of language exposure infants were getting. We observed that different family language strategies led to different a different mean exposure to French, English and Heritage languages (See Figure 2a, 2b, and 2c respectively).

Figure 2 a.

```{r, echo=FALSE}
print(figure_2_a)

```

Figure 2 b.

```{r, echo=FALSE}
print(figure_2_b)

```
 
 Figure 2 c.
 
```{r, echo=FALSE}
print(figure_2_c)

```
  
  To test this statistically, we conducted a one-way analysis of variance (ANOVA test) to explore weather some family language strategies contributed more variance to the amount of exposure babies got in French, English and/or a heritage language, regardless of whether each of those languages was their L1 or L2 language. 

In terms of French exposure, we found a statistically significant difference in how much variance the family language strategies contribute (F=`r fre_F`, p= `r fre_p`). We then conducted a Tukey HSD post-hoc analysis to determine which observed difference between means accounted for more variance(See Table 2). The post-hoc analyses showed that the one parent bilingual strategy was significantly different than the both parents bilingual, one-parent-one-language, and the one language at home strategies. The one parent bilingual strategy was associated with the lowest mean French exposure out all the strategies (see Figure 2a).

In terms of English exposure, we found a statistically significant difference in how much variance the family language strategies contribute (F=`r eng_F`, p= `r eng_p`). We then conducted a Tukey HSD post-hoc analysis to determine which observed difference between means accounted for more variance(See Table 3). The post-hoc analyses showed again that the one parent bilingual strategy was statistically significantly different than the one-parent-one-language, and the one language at home strategies. However, in the case of English, the one parent bilingual strategy was associated with the highest mean English exposure out of all the strategies (See Figure 2b).This makes sense as most of the families in our sample were French-English bilinguals, and thus English exposure was in most cases a complement to French exposure.

Finally, in terms of exposure to a heritage language, we found a difference that approached statistical difference in how much variance the family language strategies contribute (F=`r min_F`, p= `r min_p`). The fact that the the difference between strategies only approaches significance might be due to a lack of power, since the sample of families who used a heritage language was relatively small. We thus decided to also conduct a Tukey HSD post-hoc analysis. The post-hoc analysis showed that the one language at home strategy was statistically significantly different than the one-parent-one-language strategy. The one language at home strategy was associated with the lowest mean heritage language exposure, while the one-parent-one-language strategy was associated with the highest mean heritage language exposure (see Figure 2c). 

Table 2. Tukey HSD Test on the Effect of Strategies on French Exposure

```{r, echo=FALSE}
kable(tukey_fre)
```

Table 3. Tukey HSD Test on the Effect of Strategies on English Exposure

```{r}
kable(tukey_eng)
```

Table 4. Tukey HSD Test on the Effect of Strategies on Heritage Langauge Exposure

```{r}
kable(tukey_min)
```

  Finally, we wanted to explore whether families switched in their use of family language strategies across time. To explore this, we used a subset of our data that included families that had provided LEQ data two separate visits (i.e. longitudinal data). We plotted the longitudinal data (See Figure 3) to determine the stability of family strategy use across time. As can be observed, most families maintain the same family language strategy throughout both visits (See Table 5). The biggest gain between visits was for the both parents bilingual strategy which gained around 6%. The biggest loss between visits was for the one language at home strategy which lost around 5%. The most common change between strategies was from the one parent bilingual strategy, to the both parents bilingual strategy, followed by changing from the one language at home strategy to the one parent bilingual strategy.
  
```{r, include=FALSE}
## LONGITUDINAL DATA ANALYSES ##

########### Count proportions ##########

v1_strat_prop <- longitudinal_data_analyses %>%
  select(visit, strategy) %>%
  filter(visit==1) %>%
  filter(!strategy == "single-parent") %>%
  group_by(strategy) %>%
  tally()%>%
  mutate(prop = n/sum(n)) %>%
  mutate(perc= prop*100)


v2_strat_prop <- longitudinal_data_analyses %>%
  select(visit, strategy) %>%
  filter(visit==2) %>%
  filter(!strategy == "single-parent") %>%
  group_by(strategy) %>%
  tally()%>%
  mutate(prop = n/sum(n)) %>%
  mutate(perc= prop*100)

percentages_visits <- merge(v1_strat_prop, v2_strat_prop, by="strategy")

percentages_visits <- percentages_visits %>%
  select(strategy, n.x, n.y, perc.x, perc.y) %>%
  rename(n_first_visit = n.x) %>%
  rename(n_second_visit = n.y) %>%
  rename(percentage_first_visit = perc.x) %>%
  rename(percentage_second_visit = perc.y)

###########################


############ make sankey ########

wider_longitudinal <- longitudinal_data_analyses %>%
  select(anon_baby_id, visit, strategy) %>%
  filter(str_detect(strategy, "single-parent", negate=T))

wider_longitudinal <- pivot_wider(wider_longitudinal,
                                names_from = visit, values_from = strategy ) %>%
  rename(visit_1 = "1", visit_2 = "2", visit_3 ="3", visit_4 ="4" ) 



for_sankey <- wider_longitudinal %>%
  make_long(visit_1, visit_2) 

for_sankey <- for_sankey %>%
  mutate(node= fct_relevel (node, "both-parents-bilingual", "one-parent-bilingual", "one-language-at-home", "one-parent-one-language"))


p1<- ggplot(for_sankey, aes(x = x, 
               next_x = next_x, 
               node = node, 
               next_node = next_node,
               fill = factor(node), label=node )) +
  geom_sankey() 

p2<- p1+ 
      scale_fill_manual(name= "x", values = c(my_yellow, my_blue, my_orange, my_green))

p2<- p2 + 
  geom_sankey_label(size=3, color="black", fill="white")+
  theme_bw()+
  theme(legend.position = "none", axis.ticks = element_blank(), axis.text.y = element_blank()) +
  labs(title="Stability of Family Strategies Across Visit", x="")
  

```
  
  Figure 3
  
```{r echo=FALSE}
print(p2)
```

Table 5 Percentage os Family Strategy Use in Each Visit

```{r echo=FALSE}

kable(percentages_visits)
```

  
  