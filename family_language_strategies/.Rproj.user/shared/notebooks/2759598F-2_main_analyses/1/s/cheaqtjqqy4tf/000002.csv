"0","final_data <- final_data %>%"
"0","  mutate(strategy=case_when("
"0","    "
"0","  #OPOL_S: Each parent speaks only one language and both parents don't speak the same language"
"0","    care1_l1==""regularly"" & care1_l2 %in% c(""never"", ""NA"") & care2_l1 %in% c(""never"", ""NA"") & care2_l2==""regularly""~ ""OPOL_S"","
"0","    care1_l1 %in% c(""never"", ""NA"") & care1_l2==""regularly"" & care2_l1==""regularly"" &care2_l2 %in% c(""never"", ""NA"")~ ""OPOL_S"","
"0","    "
"0","  #OPOL_F: Each parent speaks mainly one language, and one of them sometimes speaks another language"
"0","  #(The same language cannot be spoken regularly by both parents or that would be considered a Biling1 strategy)"
"0","    care1_l1==""regularly"" & care1_l2 %in% c(""never"", ""NA"") & care2_l1==""sometimes"" &care2_l2==""regularly""~ ""OPOL_F"","
"0","    care1_l1==""regularly"" & care1_l2==""sometimes"" & care2_l1 %in% c(""never"", ""NA"") &care2_l2==""regularly""~ ""OPOL_F"","
"0","    care1_l1==""sometimes"" & care1_l2==""regularly"" & care2_l1==""regularly"" &care2_l2 %in% c(""never"", ""NA"")~ ""OPOL_F"","
"0","    care1_l1 %in% c(""never"", ""NA"") & care1_l2==""regularly"" & care2_l1==""regularly"" &care2_l2==""sometimes""~ ""OPOL_F"","
"0","    "
"0","    "
"0","  #Biling1: One parent speaks 2 languages, the other parent only speaks one language"
"0","    "
"0","    #Starting point"
"0","    care1_l1== ""regularly"" & care1_l2==""regularly"" & care2_l1 == ""regularly"" & care2_l2 %in% c(""never"", ""NA"") ~ ""Biling1"","
"0","    care1_l1== ""regularly"" & care1_l2==""regularly"" & care2_l1 %in% c(""never"", ""NA"") & care2_l2==""regularly"" ~ ""Biling1"","
"0","    care1_l1== ""regularly"" & care1_l2 %in% c(""never"", ""NA"") & care2_l1 == ""regularly"" & care2_l2==""regularly"" ~ ""Biling1"","
"0","    care1_l1 %in% c(""never"", ""NA"") & care1_l2==""regularly"" & care2_l1 == ""regularly"" & care2_l2==""regularly"" ~ ""Biling1"","
"0",""
"0","    #Some bilingual parents put both of their languages as sometimes rather than both as regularly"
"0","    care1_l1== ""sometimes"" & care1_l2==""sometimes"" & care2_l1 == ""regularly"" & care2_l2 %in% c(""never"", ""NA"") ~ ""Biling1"","
"0","    care1_l1== ""sometimes"" & care1_l2==""sometimes"" & care2_l1 %in% c(""never"", ""NA"") & care2_l2==""regularly"" ~ ""Biling1"","
"0","    care1_l1== ""regularly"" & care1_l2 %in% c(""never"", ""NA"") & care2_l1 == ""sometimes"" & care2_l2==""sometimes"" ~ ""Biling1"","
"0","    care1_l1 %in% c(""never"", ""NA"") & care1_l2==""regularly"" & care2_l1 == ""sometimes"" & care2_l2==""sometimes"" ~ ""Biling1"","
"0",""
"0","    #One parent bilingual (R&R or S&S) and another parent that speaks one of the language but not the other (R|S & N|NA)"
"0","    care1_l1 == ""regularly"" & care1_l2==""regularly"" & care2_l1 %in% c(""regularly"", ""sometimes"") & care2_l2 %in% c(""never"", ""NA"") ~ ""Biling1"","
"0","    care1_l1 == ""regularly"" & care1_l2==""regularly"" & care2_l1 %in% c(""never"", ""NA"") & care2_l2 %in% c(""regularly"", ""sometimes"") ~ ""Biling1"","
"0","    care1_l1 %in% c(""regularly"", ""sometimes"") & care1_l2 %in% c(""never"", ""NA"") & care2_l1 == ""regularly"" & care2_l2==""regularly"" ~ ""Biling1"","
"0","    care1_l1 %in% c(""never"", ""NA"") & care1_l2 %in% c(""regularly"", ""sometimes"") & care2_l1 == ""regularly"" & care2_l2==""regularly"" ~ ""Biling1"","
"0",""
"0","    care1_l1 == ""sometimes"" & care1_l2==""sometimes"" & care2_l1 %in% c(""regularly"", ""sometimes"") & care2_l2 %in% c(""never"", ""NA"") ~ ""Biling1"","
"0","    care1_l1 == ""sometimes"" & care1_l2==""sometimes"" & care2_l1 %in% c(""never"", ""NA"") & care2_l2 %in% c(""regularly"", ""sometimes"") ~ ""Biling1"","
"0","    care1_l1 %in% c(""regularly"", ""sometimes"") & care1_l2 %in% c(""never"", ""NA"") & care2_l1 == ""sometimes"" & care2_l2==""sometimes"" ~ ""Biling1"","
"0","    care1_l1 %in% c(""never"", ""NA"") & care1_l2 %in% c(""regularly"", ""sometimes"") & care2_l1 == ""sometimes"" & care2_l2==""sometimes"" ~ ""Biling1"","
"0","    "
"0","    #Both parents speak the same language regularly, and one of them speak another language sometimes "
"0","    #(not OPOL_F because both parents use the same language regularly in opposition to each parent having a different language that they use regularly)"
"0","    care1_l1==""regularly"" & care1_l2==""sometimes"" & care2_l1==""regularly"" & care2_l2 %in% c(""never"", ""NA"") ~ ""Biling1"","
"0","    care1_l1==""regularly"" & care1_l2 %in% c(""never"", ""NA"") & care2_l1==""regularly"" & care2_l2==""sometimes"" ~ ""Biling1"","
"0","    care1_l1==""sometimes"" & care1_l2==""regularly"" & care2_l1 %in% c(""never"", ""NA"")& care2_l2==""regularly"" ~ ""Biling1"","
"0","    care1_l1 %in% c(""never"", ""NA"") & care1_l2==""regularly"" & care2_l1==""sometimes"" & care2_l2==""regularly"" ~ ""Biling1"","
"0","    "
"0","    "
"0","  #Biling2: Both parents speak both languages either regularly or sometimes"
"0","    care1_l1%in% c(""regularly"", ""sometimes"") & care1_l2%in% c(""regularly"", ""sometimes"") & care2_l1%in% c(""regularly"", ""sometimes"") &care2_l2%in% c(""regularly"", ""sometimes"") ~ ""Biling2"","
"0",""
"0","  #OPOL_F: Each parent speaks mainly one language, and one of them sometimes speaks another language"
"0","  #The same language cannot be spoken regularly by both parents or it comes to be filled under the Biling1 strategy"
"0","    care1_l1==""regularly"" & care1_l2 %in% c(""never"", ""NA"") & care2_l1==""sometimes"" &care2_l2==""regularly""~ ""OPOL_F"","
"0","    care1_l1==""regularly"" & care1_l2==""sometimes"" & care2_l1 %in% c(""never"", ""NA"") &care2_l2==""regularly""~ ""OPOL_F"","
"0","    care1_l1==""sometimes"" & care1_l2==""regularly"" & care2_l1==""regularly"" &care2_l2 %in% c(""never"", ""NA"")~ ""OPOL_F"","
"0","    care1_l1 %in% c(""never"", ""NA"") & care1_l2==""regularly"" & care2_l1==""regularly"" &care2_l2==""sometimes""~ ""OPOL_F"","
"0","    "
"0","  #OLH: There is only one language spoken in the home by both parents"
"0","    care1_l1==""regularly"" & care1_l2 %in% c(""never"", ""NA"") & care2_l1==""regularly"" &care2_l2 %in% c(""never"", ""NA"")~ ""OLH"","
"0","    care1_l1 %in% c(""never"", ""NA"") & care1_l2==""regularly"" & care2_l1 %in% c(""never"", ""NA"") & care2_l2==""regularly""~ ""OLH"","
"0","    "
"0","    care1_l1==""sometimes"" & care1_l2 %in% c(""never"", ""NA"") & care2_l1==""sometimes"" &care2_l2 %in% c(""never"", ""NA"")~ ""OLH"","
"0","    care1_l1 %in% c(""never"", ""NA"") & care1_l2==""sometimes"" & care2_l1 %in% c(""never"", ""NA"") & care2_l2==""sometimes""~ ""OLH"","
"0","    "
"0","  #Single: Family in which there is only one caregiver"
"0","    care1_l1 %in% c(""never"", ""NA"") & care1_l2 %in% c(""never"", ""NA"") & care1_l3 %in% c(""never"", ""NA"") & care1_l4 %in% c(""never"", ""NA"") ~ ""Single"","
"0","    care2_l1 %in% c(""never"", ""NA"") & care2_l2 %in% c(""never"", ""NA"") & care2_l3 %in% c(""never"", ""NA"") & care2_l4 %in% c(""never"", ""NA"") ~ ""Single"""
"0","  "
"0","    ))"
"0","    "
"0",""
"0","#Calculate the proportion for the different strategies"
"0","prop_strategy<-all_data%>%"
"0","group_by(strategy) %>%"
"0","  tally() %>%"
"0","  mutate(prop = n/sum(n))"
"2","Error in group_by(., strategy) : object 'all_data' not found
"
